resources:
- name: log_collection
  endpoint:
    path: /api/logs
    method: GET
    data_selector: logs
    params:
      incremental: timestamp
- name: log_collection
  endpoint:
    path: /api/logs/collection
    method: GET
    data_selector: logs
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: detection_attribute
  endpoint:
    path: /detection/attributes
    method: GET
    data_selector: detection
- name: search_identifiers
  endpoint:
    path: /search/identifiers
    method: GET
    data_selector: selection
- name: suspicious_mshta_process_executions
  endpoint:
    path: /example/suspicious_mshta_process_executions
    method: GET
    data_selector: rules
    params: {}
- name: event_rules
  endpoint:
    path: /event_rules
    method: GET
    data_selector: rules
    params: {}
- name: event
  endpoint:
    path: /events
    method: GET
- name: Services (ADS - LIADS)
  endpoint:
    path: /10_active-defense-services/services-ads-liads
    method: GET
- name: Tokens (ADS - Tokens)
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens
    method: GET
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: network_services
  endpoint:
    path: /api/v3/network_services
    method: GET
    data_selector: data
    params: {}
- name: network_events
  endpoint:
    path: /api/v1/network/events
    method: GET
    data_selector: data
    params:
      incremental: timestamp
- name: threat_intelligence
  endpoint:
    path: /api/v1/threat/intelligence
    method: GET
    data_selector: data
    params: {}
- name: SSH
  endpoint:
    path: /ssh
    method: GET
    data_selector: log_data
    params: {}
- name: Telnet
  endpoint:
    path: /telnet
    method: GET
    data_selector: log_data
    params: {}
- name: FTP
  endpoint:
    path: /ftp
    method: GET
    data_selector: log_data
    params: {}
- name: SMB
  endpoint:
    path: /smb
    method: GET
    data_selector: log_data
    params: {}
- name: RDP
  endpoint:
    path: /rdp
    method: GET
    data_selector: log_data
    params: {}
- name: Elastic-Search
  endpoint:
    path: /elastic-search
    method: GET
    data_selector: log_data
    params: {}
- name: GIT Protocol
  endpoint:
    path: /git
    method: GET
    data_selector: log_data
    params: {}
- name: VNC
  endpoint:
    path: /vnc
    method: GET
    data_selector: log_data
    params: {}
- name: SIP
  endpoint:
    path: /sip
    method: GET
    data_selector: log_data
    params: {}
- name: SNMP
  endpoint:
    path: /snmp
    method: GET
    data_selector: log_data
    params: {}
- name: TFTP
  endpoint:
    path: /tftp
    method: GET
    data_selector: log_data
    params: {}
- name: HTTP_Basic_Auth
  endpoint:
    path: /basic-auth
    method: GET
    data_selector: log_data
- name: CITRIX_ADC
  endpoint:
    path: /citrix-https
    method: GET
    data_selector: log_data
- name: CISCO_ASA
  endpoint:
    path: /cisco-asa
    method: GET
    data_selector: log_data
- name: web_based_url_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/web-based-url-token
    method: GET
    data_selector: token
- name: cloned_web_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/cloned-web-token
    method: GET
    data_selector: token
- name: microsoft_word_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/microsoft-word
    method: GET
    data_selector: token
- name: microsoft_excel_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/microsoft-excel
    method: GET
    data_selector: token
- name: sensitive_command_execution_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/sensitive-command-execution
    method: GET
    data_selector: token
- name: pdf_document_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/pdf-document
    method: GET
    data_selector: token
- name: windows_directory_token
  endpoint:
    path: /10_active-defense-services/tokens-ads-tokens/windows-directory
    method: GET
    data_selector: token
- name: logging
  endpoint:
    path: /logging
    method: POST
    data_selector: logs
    params: {}
- name: Cisco Router
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/cisco-router
    method: GET
- name: events
  endpoint:
    path: /services/data/vXX.X/sobjects/Event
    method: GET
    data_selector: records
    params: {}
- name: cases
  endpoint:
    path: /services/data/vXX.X/sobjects/Case
    method: GET
    data_selector: records
    params: {}
- name: log
  endpoint:
    path: /api/v1/logs
    method: GET
    data_selector: logs
- name: events
  endpoint:
    path: /api/v1/events
    method: GET
    data_selector: data
    params: {}
- name: cases
  endpoint:
    path: /api/v1/cases
    method: GET
    data_selector: data
    params: {}
- name: syslog_notification
  endpoint:
    path: /syslog/notification
    method: POST
    data_selector: notification
    params:
      syslog_server: IP address of the Log Collector
      port: 514
      log_type: SMS 2.0 / 2.1 Syslog format
      facility: Log Audit
      severity: Severity in Event
      delimiter: TAB
      include_timestamp: Use original event timestamp
      include_hostname: Include SMS Hostname in Header
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: networks
  endpoint:
    path: /organizations/{organizationId}/networks
    method: GET
    data_selector: networks
- name: devices
  endpoint:
    path: /networks/{networkId}/devices
    method: GET
    data_selector: devices
- name: audit_logs
  endpoint:
    path: /api/rest/json/v1/audit/logs
    method: GET
    data_selector: operation.Details
    params:
      rowsPerPage: rows_per_page
      page: page
- name: Activity Log
  endpoint:
    path: workspaces/2408598000001819004/views/2408598000001819448/data
    method: GET
    data_selector: records
- name: API Logs
  endpoint:
    path: workspaces/2408598000001819004/views/2408598000017048838/data
    method: GET
    data_selector: records
- name: Access Logs
  endpoint:
    path: workspaces/2408598000001819004/views/2408598000001819010/data
    method: GET
    data_selector: records
- name: audit_logs
  endpoint:
    path: /api/v1/audit-logs
    method: GET
    data_selector: logs
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: scans_list
  endpoint:
    path: /api/v1/scans/list/
    method: GET
    data_selector: records
- name: managed_devices
  endpoint:
    path: /v1.0/deviceManagement/managedDevices
    method: GET
    data_selector: value
- name: managed_device_overview
  endpoint:
    path: /v1.0/deviceManagement/managedDeviceOverview
    method: GET
    data_selector: value
- name: detected_apps
  endpoint:
    path: /v1.0/deviceManagement/detectedApps
    method: GET
    data_selector: value
- name: alert_configuration
  endpoint:
    path: /configuration/alerts
    method: POST
    data_selector: alert_settings
    params:
      remote_syslog: enabled
      syslog_server_1: '[Log Collector IP of specific branch]'
      port: 12441
- name: log_entry
  endpoint:
    path: /api/logs
    method: GET
    data_selector: logs
- name: Remote Syslog
  endpoint:
    path: /management/remote_syslog
    method: POST
    data_selector: logs
    params:
      remote_syslog_port: 12445
      remote_syslog_server: '[Log Collector IP of specific branch]'
- name: Syslog Recipient
  endpoint:
    path: /events/alert_recipients
    method: POST
    data_selector: recipient
    params:
      recipient_name: BluLogCollector
      ip_address: '[Log Collector IP of specific branch]'
      port: 12442
      status: Enabled
      event_type:
      - Critical
      - Warning
      - System
- name: events
  endpoint:
    path: /api/v1/events
    method: GET
    data_selector: records
    params: {}
- name: cases
  endpoint:
    path: /api/v1/cases
    method: GET
    data_selector: records
    params: {}
- name: Log Configuration
  endpoint:
    path: /chassis/faults-logs/logging-controls
    method: POST
    data_selector: logs
    params:
      hostname: '[Log Collector IP of specific branch]'
      port: 12443
      protocol: UDP
      minimum_severity: Debug
- name: log_forwarding
  endpoint:
    path: /config/logging
    method: POST
    data_selector: confirmation
    params:
      host: 10.20.100.161
      udp_port: 12520
- name: CentOS & RHEL Log Integration
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/centos-and-rhel-log-integration
    method: GET
- name: audit_log
  endpoint:
    path: /etc/rsyslog.d/auditlog.conf
    method: GET
    data_selector: lines
    params: {}
- name: audit_rules
  endpoint:
    path: /etc/audit/rules.d/audit.rules
    method: GET
    data_selector: lines
    params: {}
- name: syslog_forwarding
  endpoint:
    path: /logging/host
    method: POST
    data_selector: configuration
    params:
      ip: 10.20.100.161
      port: 12515
      severity: debugging
- name: syslog_forwarding
  endpoint:
    path: /logging/host
    method: POST
    data_selector: configuration
    params:
      host_ip: 10.20.100.161
      port: 12515
      severity: debugging
      source_interface: vlan10
- name: event
  endpoint:
    path: /api/v1/events
    method: GET
    data_selector: records
- name: case
  endpoint:
    path: /api/v1/cases
    method: GET
    data_selector: records
- name: syslog_policy
  endpoint:
    path: /api/v1/syslog_policy
    method: POST
    data_selector: policy
    params: {}
- name: syslog_servers
  endpoint:
    path: /settings/notifications/syslog
    method: POST
    data_selector: servers
    params:
      ip_address: '[Log Collector IP of specific branch]'
      port: 12427
      protocol: UDP
      facility: Level 7
- name: syslog_forwarding
  endpoint:
    path: /logging/server
    method: POST
    data_selector: response
    params:
      ip: 10.20.100.161
      protocol: udp
      port: 12421
- name: logging_level
  endpoint:
    path: /logging/level
    method: POST
    data_selector: response
    params:
      level: all
      severity: 7
- name: audit_logs
  endpoint:
    path: /audit/logs
    method: POST
    data_selector: logs
    params:
      server_address: '[Log Collector IP of specific branch as allocated]'
      protocol: UDP
      port: 12425
- name: alerts
  endpoint:
    path: /alerts
    method: POST
    data_selector: alerts
    params:
      server_address: '[Log Collector IP of specific branch as allocated]'
      port: 12425
- name: Net Gear Ready NAS 314 & Net Gear Ready NAS 428
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/net-gear-ready-nas-314-and-net-gear-ready-nas-428
    method: GET
- name: Net Gear Ready NAS 314
  endpoint:
    path: /log-forwarding/net-gear-ready-nas-314
    method: GET
- name: Net Gear Ready NAS 428
  endpoint:
    path: /log-forwarding/net-gear-ready-nas-428
    method: GET
- name: event_access_logs
  endpoint:
    path: /logs/event_access
    method: POST
    data_selector: logs
    params:
      port: 12522
      transfer_protocol: UDP
      log_type: Event & Access Logs
- name: syslog_agent
  endpoint:
    path: /builds/seqrite/760/en/SyslogAgent/SQSYSAGINST.EXE
    method: GET
    data_selector: null
    params: {}
- name: syslog_configuration
  endpoint:
    path: /etc/rsyslog.conf
    method: PATCH
    data_selector: configuration
    params: {}
- name: audit_rules
  endpoint:
    path: /etc/audit/rules.d/audit.rules
    method: PATCH
    data_selector: rules
    params: {}
- name: vcenter_logs
  endpoint:
    path: /services/data/vXX.X/sobjects/VcenterLog
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: microsoft_sql_db
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/microsoft-sql-db-integration
    method: GET
- name: oracle_db
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/oracle-db-integration
    method: GET
- name: cisco_sf_sg_200_300_series_switches
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/cisco-sf-sg-200-and-300-series-switches
    method: GET
- name: cisco_sf_sg_switches
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/cisco-sf-sg-200-and-300-series-switches
    method: GET
- name: oracle_db
  endpoint:
    path: /log-forwarding/oracle-db-integration
    method: GET
    data_selector: records
- name: table_name
  endpoint:
    statement: SELECT * FROM (TABLE_NAME) WHERE (UNIQUE_FIELD) > :sql_last_value
- name: event_selection
  endpoint:
    path: /services/data/v76/sobjects/EventSelection
    method: POST
    data_selector: records
- name: siem_integration
  endpoint:
    path: /admin/siem_integration
    method: POST
    data_selector: event_logs
    params:
      syslog_server_ipurl: Syslog Server IPURL
      siem_server_port: SIEM Server Port number
      protocol: Protocol
      data_format: Data format
- name: syslog_forwarding
  endpoint:
    path: /logging/X.X.X.X/udp/12311
    method: POST
    data_selector: logs
    params:
      severity: debug
- name: Events
  endpoint:
    path: /events
    method: GET
    data_selector: records
    params: {}
- name: Cases
  endpoint:
    path: /cases
    method: GET
    data_selector: records
    params: {}
- name: FIM Integration with GPO
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/windows-fim/fim-integration-with-gpo
    method: GET
- name: FIM Integration without GPO
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/windows-fim/fim-integration-without-gpo
    method: GET
- name: logs
  endpoint:
    path: /api/v1/logs
    method: GET
    data_selector: data
    params:
      incremental: timestamp
- name: SAP
  endpoint:
    path: /log-forwarding/sap
    method: GET
- name: event
  endpoint:
    path: /events
    method: GET
    data_selector: records
    params: {}
- name: events
  endpoint:
    path: /services/data/vXX.X/sobjects/Event
    method: GET
    data_selector: records
- name: cases
  endpoint:
    path: /services/data/vXX.X/sobjects/Case
    method: GET
    data_selector: records
- name: vios_log
  endpoint:
    path: /vios/log
    method: GET
- name: syslog
  endpoint:
    path: /var/log/syslog.out
    method: POST
- name: oracle_jdbc
  endpoint:
    path: /opt/lc/scripts/<DB_PIPELINE>/01-input.conf
    method: POST
    data_selector: jdbc
    params:
      jdbc_driver_class: Java::oracle:jdbc.driver.OracleDriver
      jdbc_connection_string: jdbc:oracle:thin:@<DB_IP>:<DB_PORT_NO>:<DB_NAME>
      jdbc_user: <DB_USERNAME>
      jdbc_password: <DB_PASSWORD>
      schedule: '* * * *'
      statement: SELECT * FROM (TABLE_NAME) WHERE (UNIQUE_FIELD) > :sql_last_value
      use_column_value: true
      tracking_column: take the unique field from table structure
      tracking_column_type: <UNIQUE_FIELD_DATA_TYPE>
      last_run_metadata_path: /opt/lc/data/sql_last_value1.yml
      record_last_run: true
- name: Cisco SF/SG 200 & 300 Series Switches
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/cisco-sf-sg-200-and-300-series-switches
    method: GET
- name: Cisco SF/SG 200 & 300 Series Switches
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/cisco-sf-sg-200-and-300-series-switches
    method: GET
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: siem_integration
  endpoint:
    path: /admin/siem_integration
    method: POST
    data_selector: events
    params:
      syslog_server: Syslog Server IPURL
      port: SIEM Server Port number
      protocol: UDP or TCP
      data_format: LEEF or CEF
- name: Seqrite Endpoint Security 7.6 Log Integration
  endpoint:
    path: /12_deployment-log-forwarding/log-forward/seqrite-endpoint-security-7.6-log-integration
    method: GET
- name: Azure AD logs
  endpoint:
    path: /streaming/azure-active-directory-logs
    method: GET
    data_selector: logs
- name: Azure Monitor logs
  endpoint:
    path: /streaming/azure-monitor-logs
    method: GET
    data_selector: logs
- name: Azure Application Gateway logs
  endpoint:
    path: /streaming/application-gateway-logs
    method: GET
    data_selector: logs
- name: Azure SQL Database logs
  endpoint:
    path: /streaming/sql-database-logs
    method: GET
    data_selector: logs
- name: Microsoft Defender ATP logs
  endpoint:
    path: /streaming/defender-atp-logs
    method: GET
    data_selector: logs
- name: Microsoft Intune logs
  endpoint:
    path: /streaming/intune-logs
    method: GET
    data_selector: logs
- name: EventHub
  endpoint:
    path: /eventhub
    method: POST
    data_selector: events
    params: {}
- name: Audit.AzureActiveDirectory
- name: Audit.Exchange
- name: Audit.SharePoint
- name: Audit.General
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: Service Account GPO
  endpoint:
    path: /GroupPolicy/ServiceAccountGPO
    method: GET
    data_selector: records
- name: Security Group
  endpoint:
    path: /ActiveDirectory/SecurityGroups/ServiceAccount
    method: POST
    data_selector: result
- name: Allow remote server management through WinRM
  endpoint:
    path: /Computer Configuration/Policies/Administrative Templates/Windows Components/Windows
      Remote Management (WinRM)/WinRM Services
    method: GET
    data_selector: settings
    params: {}
- name: 'Windows Firewall: Allow inbound remote administration exception'
  endpoint:
    path: /Computer Configuration/Policies/Administrative Templates/Policy definitions/Network/Network
      Connections/Windows Firewall or Windows Defender Firewall/Domain Profile
    method: GET
    data_selector: settings
    params: {}
- name: 'Windows Firewall: Allow ICMP exception'
  endpoint:
    path: /Computer Configuration/Policies/Administrative Templates/Policy definitions/Network/Network
      Connections/Windows Firewall or Windows Defender Firewall/Domain Profile
    method: GET
    data_selector: settings
    params: {}
- name: SPAN Configuration
  endpoint:
    path: /system/virtual-switch
    method: POST
    data_selector: ''
    params: {}
- name: traffic_mirror_target
  endpoint:
    path: /create_traffic_mirror_target
    method: POST
    data_selector: target
    params: {}
- name: traffic_mirror_filter
  endpoint:
    path: /create_traffic_mirror_filter
    method: POST
    data_selector: filter
    params: {}
- name: traffic_mirror_session
  endpoint:
    path: /create_traffic_mirror_session
    method: POST
    data_selector: session
    params: {}
- name: BluGenieChildItemList
  endpoint:
    path: /blugenie/child/item/list
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: Enable-BluGenieWinRMoverWMI
  endpoint:
    path: /Enable-BluGenieWinRMoverWMI
    method: POST
    data_selector: output
    params:
      ComputerName: String
      looptimer: 5
      termloopcounter: 6
      MaxConcurrentUsers: 25
      MaxProcessesPerShell: 100
      MaxMemoryPerShellMB: 1024
      MaxShellsPerUser: 30
      MaxShellRunTime: 2147483647
      SetMaxValues: false
      SetValues: false
      ReturnDetails: false
      Walkthrough: false
      ReturnObject: false
      OutUnEscapedJSON: false
      FormatView: Table
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: Certification Services
  endpoint:
    path: /certification_services
    method: GET
    data_selector: events
    params:
      volume: Low to medium
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Detailed File Share
  endpoint:
    path: /detailed_file_share
    method: GET
    data_selector: events
    params:
      volume: Very high for file servers and DCs
      default_settings: No Auditing
      recommended_settings: No Auditing
- name: File Share
  endpoint:
    path: /file_share
    method: GET
    data_selector: events
    params:
      volume: High for file servers and DCs
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: File System
  endpoint:
    path: /file_system
    method: GET
    data_selector: events
    params:
      volume: Depends on SACL rules
      default_settings: No Auditing
      recommended_settings: Enable SACLs just for sensitive files
- name: Filtering Platform Connection
  endpoint:
    path: /filtering_platform_connection
    method: GET
    data_selector: events
    params:
      volume: High
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Filtering Platform Packet Drop
  endpoint:
    path: /filtering_platform_packet_drop
    method: GET
    data_selector: events
    params:
      volume: High
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Kernel Object
  endpoint:
    path: /kernel_object
    method: GET
    data_selector: events
    params:
      volume: High if auditing access of global object access is enabled
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Handle Manipulation
  endpoint:
    path: /handle_manipulation
    method: GET
    data_selector: events
    params:
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Other Object Access Events
  endpoint:
    path: /other_object_access_events
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Registry
  endpoint:
    path: /registry
    method: GET
    data_selector: events
    params:
      volume: Depends on SACLs
      default_settings: No Auditing
      recommended_settings: Set SACLs for only the registry keys that you want to
        monitor
- name: Removable Storage
  endpoint:
    path: /removable_storage
    method: GET
    data_selector: events
    params:
      volume: Depends on how much removable storage is used
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: SAM
  endpoint:
    path: /sam
    method: GET
    data_selector: events
    params:
      volume: High volume of events on Domain Controllers
      default_settings: No Auditing
      recommended_settings: Success and Failure
- name: Audit Policy Change
  endpoint:
    path: /audit_policy_change
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: Success
      recommended_settings: Success and Failure
- name: Authentication Policy Change
  endpoint:
    path: /authentication_policy_change
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: Success
      recommended_settings: Success and Failure
- name: Authorization Policy Change
  endpoint:
    path: /authorization_policy_change
    method: GET
    data_selector: events
    params:
      volume: Medium to High
      default_settings: No Auditing
      recommended_settings: Unknown. Needs testing.
- name: Filtering Platform Policy Change
  endpoint:
    path: /filtering_platform_policy_change
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: No Auditing
      recommended_settings: Unknown, Needs testing.
- name: MPSSVC Rule-Level Policy Change
  endpoint:
    path: /mpssvc_rule_level_policy_change
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: No Auditing
      recommended_settings: Unknown. Needs testing.
- name: Other Policy Change Events
  endpoint:
    path: /other_policy_change_events
    method: GET
    data_selector: events
    params:
      volume: Low
      default_settings: No Auditing
      recommended_settings: No Auditing
- name: privilege_use_non_sensitive
  endpoint:
    path: /privilege_use/non_sensitive
    method: GET
    data_selector: events
- name: privilege_use_sensitive
  endpoint:
    path: /privilege_use/sensitive
    method: GET
    data_selector: events
- name: other_system_events
  endpoint:
    path: /system/other_events
    method: GET
    data_selector: events
- name: security_state_change
  endpoint:
    path: /security/state_change
    method: GET
    data_selector: events
- name: security_system_extension
  endpoint:
    path: /security/system_extension
    method: GET
    data_selector: events
- name: system_integrity
  endpoint:
    path: /system/integrity
    method: GET
    data_selector: events
- name: global_object_access_auditing
  endpoint:
    path: /global_object/access_auditing
    method: GET
    data_selector: events
- name: default_logs
  endpoint:
    path: /default/logs
    method: GET
    data_selector: events
- name: boot_events
  endpoint:
    path: /boot_events
    method: GET
    data_selector: records
- name: application_crashes
  endpoint:
    path: /application_crashes
    method: GET
    data_selector: records
- name: group_policy_errors
  endpoint:
    path: /group_policy_errors
    method: GET
    data_selector: records
- name: kernel_driver_signing
  endpoint:
    path: /kernel_driver_signing
    method: GET
    data_selector: records
- name: software_and_service_installation
  endpoint:
    path: /software_and_service_installation
    method: GET
    data_selector: records
- name: system_integrity
  endpoint:
    path: /system_integrity
    method: GET
    data_selector: records
- name: account_usage
  endpoint:
    path: /account_usage
    method: GET
    data_selector: records
- name: application_whitelisting
  endpoint:
    path: /application_whitelisting
    method: GET
    data_selector: records
- name: certificate_services
  endpoint:
    path: /certificate_services
    method: GET
    data_selector: records
- name: network_policy
  endpoint:
    path: /network_policy
    method: GET
    data_selector: records
- name: Account Management
  endpoint:
    path: /log/account_management
    method: GET
    data_selector: events
    params: {}
- name: Active Directory
  endpoint:
    path: /log/active_directory
    method: GET
    data_selector: events
    params: {}
- name: Application Error and Hang
  endpoint:
    path: /log/application_error_hang
    method: GET
    data_selector: events
    params: {}
- name: Authentication Events
  endpoint:
    path: /log/authentication_events
    method: GET
    data_selector: events
    params: {}
- name: Firewall Events
  endpoint:
    path: /log/firewall_events
    method: GET
    data_selector: events
    params: {}
- name: Kerberos
  endpoint:
    path: /log/kerberos
    method: GET
    data_selector: events
    params: {}
- name: event_ids
  endpoint:
    path: /lateral_movement_logging/event_ids
    method: GET
    data_selector: event_ids
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: event
  endpoint:
    path: /api/v1/events
    method: GET
    data_selector: data
    params: {}
- name: case
  endpoint:
    path: /api/v1/cases
    method: GET
    data_selector: data
    params: {}
- name: Threat Intelligence
  endpoint:
    path: /api/threat_intelligence
    method: GET
    data_selector: records
- name: Network Data
  endpoint:
    path: /api/network_data
    method: GET
    data_selector: records
- name: Endpoint Data
  endpoint:
    path: /api/endpoint_data
    method: GET
    data_selector: records
- name: categories
  endpoint:
    path: /18_taxonomy
    method: GET
    data_selector: categories
    params: {}
- name: logs
  endpoint:
    path: /20_m-soc_self-service-portal/default-log-collection
    method: GET
    data_selector: logs
    params: {}
- name: incident_management
  endpoint:
    path: /20_m-soc_self-service-portal/incident-management-workflow-m-soc-only
    method: GET
    data_selector: incidents
    params: {}
- name: documents
  endpoint:
    path: /documents
    method: POST
    data_selector: documentList
    params: {}
- name: Log Collector
  endpoint:
    path: /log-collector
    method: GET
    data_selector: records
- name: Responder
  endpoint:
    path: /responder
    method: GET
    data_selector: records
notes:
- Requires Mimecast account and API access setup.
- Uses OAuth2 with refresh token — requires setup of connected app in api
- Ensure correct permissions are set for OAuth token.
- You must complete the following to successfully configure and verify your Mimecast
  log collector
- The access keys generated for the application do not expire based on the Authentication
  Profile's Authentication TTL value.
- Ensure to replace the \u003d\u003d at the end of the secret key with == when used.
- Some objects like Contact may return nulls in deeply nested fields
- BluSapphire has agentless architecture which consist of sensor, master and ODP.
- BluSapphire can respond to threats in seconds and take automated actions like Quarantine,
  Suspend Process, Clean and collect forensics.
- Uses agentless approach for collecting forensics from endpoint systems.
- Open Data Platform (ODP) is an integral part of the BluSapphire platform.
- Some objects may return nulls in deeply nested fields
- The integration is for pxGrid 2.0 and compatible with Cisco ISE 2.4 and above.
- The below configuration works without certs for now. Support for Certs will be added
  soon.
- Please check if you completed all the Registration Steps shown in the Registration
  section above.
- Check that the Registration Status shows 'Enabled'.
- If the registration status shows 'Pending' or 'Disabled'. Login to Cisco ISE console
  go to Cisco ISE -> pxGrid -> Web Clients and verify the client status is shown ON.
- BluSapphire relies on NetFlow Data to detect lateral movement.
- BluSapphire does not rely on signature information.
- One of the unique features of BluSapphire is that we do not rely on any SSL gateway(s)
  to detect this.
- The default schedule for threat intelligence dissemination is every hour.
- It is strongly advisable to use an IDE like VSCode (free from Microsoft) to edit
  / work with Sigma files. They natively support YAML formatting and can help you
  save a lot of heartburn w.r.t to YAML formatting.
- Newly created rules will be enabled by default.
- Requires setup of connected app in BluSapphire
- The Credentials Manager is a central location to store secrets allowing Case-Hub
  and all its components to authenticate to other systems.
- Agent creation and deployment require Administrative privileges
- ADS-Tokens are currently in beta, and are based on CaranyTokens by Thinkst Canary
- API requires authentication via OAuth2 with a connected app.
- Ensure to handle token expiration gracefully.
- Requires OAuth2 setup for API access
- Rate limits apply to API usage
- Log data captured include 'Source-IP, Destination-IP, Username/Password used during
  login attempt'
- MYSQL service options 'Port, Display Banner' can be configured and adjusted as per
  the deployed environment.
- DPM helps the process of onboarding and managing data from various sources.
- DPM allows you to easily create and manage data pipelines without requiring extensive
  manual intervention.
- Ensure correct API version for log forwarding.
- This can only be configured using CLI
- Syslog format is preferred over WELF, in order to support vdom in Fortigate firewalls.
- Do not select CSV format for exporting the logs.
- Logs can be sent to the default UDP port 514 if syslog_port is left blank.
- Check Appendix A for default port.
- For more information, refer the Cisco IOS Switch documentation.
- Uses OAuth2 with refresh token — requires setup of connected app in API
- Ensure proper configuration of VPN for log collection
- This package holds pre-defined audit rules as per the audit recommendations.
- 'Install syslog package if you haven’t installed it by executing the command: apt-get
  install rsyslog'
- 'At the end of the rsyslog.conf file check for the line: $IncludeConfig /etc/rsyslog.d/*.conf
  and uncomment it.'
- Open a auditd.conf file located at /etc/audit/auditd.conf.
- Restart auditd service to reflect the changes.
- Create log configuration for Audit logs with vim /etc/rsyslog.d/auditlog.conf and
  paste the specified lines.
- Install syslog package, if you haven’t installed it
- Create log configuration for Audit logs with vim /etc/rsyslog.d/auditlog.conf and
  paste following lines below
- SAP stores logs in binary format by default. A schedule task to dump logs in CSV
  format has to be created in SAP.
- 'Save SAP logs on particular folder (eg: /opt/g14/saplogs/) on the system/server
  in csv format.'
- 'Schedule an activity in SAP to generate the audit logs in required intervals (eg:
  hourly).'
- Download and install filebeat latest version by using below link.
- Before starting Filebeat Edit filebeat.yml file.
- In Filebeat input session, can modify input enabled field False to true.
- Place your log folder path(step-2) under paths field.
- 'Under Elastic search output session, put # to all lines.'
- Under Logstash output session, remove comments (#) and place IP and Port.
- Modify localhost to Log collector IP and modify port number (provided by blusapphire).
- After configuration is completed then Start the Filebeat service on PowerShell.
- API key required for authentication
- Rate limits apply to API calls
- Uses OAuth2 with refresh token — requires setup of connected app in Zoho Vault
- Ensure log file exists to store total count
- Uses OAuth2 with refresh token — requires setup of connected app in Zoho Analytics
- Replace POWER_API_URL and POWER_AUTH_TOKEN with the values obtained from the client.
- Setup a Logstash pipeline to fetch the logs at input port 12225/tcp.
- If Syslog Server 1 is already used, Enter details in Syslog Server 2 or Syslog Server
  3.
- Configure Log Forwarding by entering details as specified
- Configured Server details will be displayed after setup.
- Requires setup of connected app in api
- Enable Remote Syslog Server 1 or 2.
- 'To configure the IP address of a syslog server to which the Aruba 6200F-48 switch
  can direct the logs, you can follow these steps:'
- Connect to the switch using a console cable or a Telnet/SSH session.
- Enter the privileged EXEC mode by typing `enable` and providing the password if
  prompted.
- Enter the global configuration mode by typing `configure terminal`.
- Enter the logging configuration mode by typing `logging`.
- Specify the IP address of the syslog server by typing `host <ip-address>`. You can
  also specify the UDP port number and the facility level by adding `port <port-number>`
  and `facility <facility-level>` respectively.
- Logging level will be automatically set by the above command.
- 514 port is the syslog default port number. Please replace 514 with blusapphire
  shared port number and provide log collector private IP.
- Replace X.X.X.X with Log Collector IP of specific branch with the Port Number same
  as above.
- Log integration requires configuration of Syslog Forwarding
- Configuration verified using the command to show syslog-parameters
- Requires OAuth2 authentication
- Ensure to configure both IPv4 and IPv6 in the Fabric Interconnect through the CLI.
- Replace 10.20.100.161 with Log Collector IP of specific branch.
- Tick all the options under Notifications and Messages
- Configured to send Audit Logs to Log Collector
- Configured to send Alerts to Log Collector
- If the certificate becomes invalid later, the TLS handshake will fail. As a result,
  an error message is posted to the audit log and messages are no longer sent to the
  syslog server.
- Log integration procedure requires configuration of Syslog settings on the switch.
- Admin Status must be enabled to forward logs.
- In the syslog Configuration, next to the Admin Status, select the Enable radio button.
- Configured QNAP to send Event & Access logs to Log Collector
- Enable logging to remote syslog server check box must be selected.
- Primary Syslog Server Address must be configured with the Log Collector IP of specific
  branch.
- Port must be set to 12423.
- SyslogAgent service will start automatically as per the set schedule
- Add line '*.* @<Log Collector IP>:12514' to rsyslog.conf
- Restart rsyslog service after configuration
- Specific configuration steps may be required for integration.
- Data formats supported are LEEF (Log Event Extended Format) and CEF (Common Event
  Format) only.
- The data formats supported are LEEF (Log Event Extended Format) and CEF (Common
  Event Format) only.
- Requires configuration through CLI Terminal
- Log Collector IP must be specified
- Setup of API access is required through Sophos management console
- Rate limits may apply on API calls
- SAP stores logs in binary format by default.
- A schedule task to dump logs in CSV format has to be created in SAP.
- 'Download and install filebeat latest version by using below link: https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation-configuration.html'
- AWS is selected, by default, as the storage solution.
- Bucket names must be globally unique and Encryption for the AWS S3 buckets is not
  supported.
- The generated token is valid for 3 hours. After that time, a new token must be generated.
- If more than 20 connection attempts are made within 60 minutes, the account will
  be locked for an hour.
- A single bucket must be selected as Active. SIEM data is exported to the active
  bucket.
- Ensure that logging is enabled. You can select the log file format (W3C is commonly
  used) and specify the log file directory if needed.
- Refer to the documentation for specific configuration instructions.
- Enable Syslog daemon & updating Syslog Config file.
- Ensure you select Standard tier while creating Event Hub Namespace
- Some log sources automatically create their own event hub
- Customer/ Partner to decide on what events should be consumed by the SIEM
- You can have up to three settings
- Some log sources automatically create their own event hub like insights-logs-auditlogs,
  insights-logs-signinlogs, insights-activity-logs.
- Ensure you select Standard tier while creating Event Hub Namespace.
- Customer/ Partner to decide on what events should be consumed by the SIEM.
- Uses OAuth2 with client secret — requires setup of application in Azure
- Make sure to take note of Application (client) ID and Directory (tenant) ID
- Enabling unified audit logging isn't required if you're only using the Office 365
  Service Communications API.
- Requires setup of connected app in Azure AD
- Store the tenant ID for access token requests
- Verify log delivery by monitoring the S3 bucket for incoming log files.
- Requires setup of connected app in Azure
- API may have rate limits or specific usage policies
- This integration will allow to fetch Incident and associated Alert data from Azure
  Sentinel to BluSapphire.
- Customer to share 'Resource Group', 'Subscription ID', Workspace Name' with BluSapphire
  deployment engineering team.
- Logs are CSV formatted, compressed (gzip), and saved every ten minutes.
- By default, Umbrella saves your event data logs to Cisco's California location.
  however, you can change the location of the data warehouse at any time.
- You must have read & write access to manage event streams on your Cisco AMP for
  Endpoints platform. If its to fetch, only read access is needed
- Repeat above steps if you want to add multiple syslog servers. Maximum five syslog
  servers can be added.
- Crowdstrike API Event Streaming scope access required
- The date and time on the host running the Falcon SIEM Connector must be current
  (NTP is recommended)
- Enable SIEM integration in Microsoft Defender ATP
- Assign permissions to the WindowsDefenderATPSiemConnector application
- BluArmour MSI Package generation is initiated post sign off between BluSapphire
  and Client.
- Test BluArmour package in the UAT environment before production roll out.
- Service Account domain users can now access all PCs remotely as a local administrator.
- Service should be set up to Startup "Automatic (Delayed Start)"
- We recommend using only the responder IP Address. If the domain(s) spread across
  multiple geographies, where some subnets may hide behind NATs, then we recommend
  using "*" for the duration of the engagement.
- This procedure explains how to configure Fortinet FortiGate switches for port mirroring
  on models with built-in hardware switches.
- You can have up to three active sessions on each ENI.
- The source and target ENIs can be in distinct VPCs as long as they are peered to
  each other or connected through Transit Gateway.
- Plan to mirror traffic to a Network Load Balancer and then run your capture & analysis
  tools on an Auto Scaled fleet of EC2 instances behind it.
- The replicated traffic generated by each instance will count against the overall
  bandwidth available to the instance. If traffic congestion occurs, mirrored traffic
  will be dropped first.
- 'GLIBC Version: Must be 2.28 or greater'
- No Signature updates needed
- No internet connectivity required
- Endpoints are protected whether they are connected to organization network or not
- No installation pre-requisites (.NET, C++, Redist, etc.)
- No reboot required during installation, uninstallation or upgrade
- Very Lightweight on resources
- Less than 100kb in memory
- Less than <1% CPU utilization
- Rapid installation with MSI packages for 32/64 bit Windows Desktop or Server
- Supports legacy versions including older XP versions
- At an organizational level, you can configure the Security log audit policies with
  Group Policy or InTune.
- You should always enable Security log auditing at the sub-category level instead
  of the broad category level.
- You cannot turn on or off specific event IDs, only sub-categories at the most granular
  level.
- Enable only for servers providing AD CS role services.
- Many event IDs are enabled. Only the ones with BluSapphire rules are shown.
- Non-sensitive and sensitive privilege use events use the same event ID.
- It is not recommended to enable the Group Policy setting for backing up and restoring
  files due to the high number of events recorded.
- There are too many events that are enabled with this sub-category to list up and
  no BluSapphire detection rules that use these event IDs at the moment.
- Collect various event IDs for comprehensive security auditing.
- Ensure to monitor authentication events for potential breaches.
- Best practice is to use Group Policy to centrally manage your audit policy.
- Using local settings can be risky as a group policy could override the local policy
  settings.
- List of event IDs to monitor for lateral movement detection.
- This page attempts to provide the reader an understanding of the best data sources
  that provide detection based on Mitre ATT&CK framework.
- Must-have logs include Entra ID Sign-in logs, Entra ID Audit logs, Azure Activity
  log, Unified Audit Log.
- Should-have logs include Microsoft Graph Activity Logs.
- Nice-to-have logs include Storage audit logging, Netflow logging, Other resource
  logs.
- Requires OAuth2 authentication for all API calls.
- Rate limiting may apply depending on usage.
- Threat Hunting requires detailed logs for effective operations.
- Agentless Framework allows for Live On-Demand Threat Hunts.
- 'MSSP’s Primary Responsibilities: SOC operations, including monitoring, alert analysis,
  and incident detection.'
- 'RE’s Primary Responsibilities: Security governance and compliance with internal/external
  policies.'
- Logs are retained for 6 months online and 18 months offline as per SEBI requirements.
- You will need `sudo` access to execute the installation command.
- Email notifications are sent with instructions to proceed with signing.
- Additional access restrictions may apply to the document.
- GLIBC Version must be 2.9 or greater
- All logs are retained for 6 months online and 18 months offline as per SEBI requirements.
- Access limited to specific subscriptions can create issues during incident response.
- Insufficient permissions may hinder the ability to respond to incidents effectively.
errors:
- 'INVALID_TOKEN: Check token validity or reauthenticate.'
- 'PERMISSION_DENIED: Verify access rights for the requested resource.'
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- '401 Unauthorized: Check OAuth token validity.'
- '429 Too Many Requests: Rate limit exceeded.'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- '401 Unauthorized: Check if the access token is valid.'
- '403 Forbidden: Ensure you have the necessary permissions.'
- '500 Internal Server Error: Retry the request after a short delay.'
- '429 Too Many Requests: Reduce frequency of requests'
- '500 Internal Server Error: Retry after some time'
- '401 Unauthorized: Check API key or token validity'
- '404 Not Found: Ensure correct endpoint URL'
- '429 Too Many Requests: Exceeded rate limit'
- '404 Not Found: The requested resource does not exist'
- 'HTTP error: Handle HTTPError exceptions'
- Failed to retrieve the access token.
- Failed to get access token
- Failed to fetch logs for view
- '401 Unauthorized: Check your credentials'
- '404 Not Found: Ensure the endpoint is correct'
- '429 Too Many Requests: Exceeding API rate limits'
- '403 Forbidden: Check API permissions'
- '401 Unauthorized: Verify client credentials and access token'
- '429 Too Many Requests: Throttle API calls or reduce frequency'
- 'Event Log Service Shutdown: Rare event'
- 'Logs Dropped: Rare event'
- 'Sec Log Cleared: High severity'
- 'Sec Log Full: High severity'
- 'Event not found: Check the event ID.'
- 'Access denied: Ensure proper permissions are set.'
- '429 Too Many Requests: Throttle your requests to avoid hitting the limit.'
- '401 Unauthorized: Check your authentication credentials.'
auth_info:
  mentioned_objects:
  - OAuth2Token
  - OauthToken
  - AuthProvider
  - Application ID
  - Application Key
  - Access Key
  - Secret Key
  - NamedCredential
  - OAuth2
  - AccessToken
  - ClientCredentials
client:
  base_url: https://docs.blusapphire.io
  auth:
    type: oauth2
    flow: refresh_token
source_metadata: null
