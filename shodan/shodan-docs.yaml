resources:
- name: host_information
  endpoint:
    path: /shodan/host/{ip}
    method: GET
    data_selector: data
    params: {}
- name: host_count
  endpoint:
    path: /shodan/host/count
    method: GET
    data_selector: total
    params: {}
- name: host_search
  endpoint:
    path: /shodan/host/search
    method: GET
    data_selector: matches
    params: {}
- name: search_facets
  endpoint:
    path: /shodan/host/search/facets
    method: GET
- name: search_filters
  endpoint:
    path: /shodan/host/search/filters
    method: GET
- name: search_tokens
  endpoint:
    path: /shodan/host/search/tokens
    method: GET
- name: alert_create
  endpoint:
    path: /shodan/alert
    method: POST
    data_selector: filters
    params: {}
- name: alert_info
  endpoint:
    path: /shodan/alert/{id}/info
    method: GET
    data_selector: filters
    params: {}
- name: alert_delete
  endpoint:
    path: /shodan/alert/{id}
    method: DELETE
    data_selector: success
    params: {}
- name: alert_edit
  endpoint:
    path: /shodan/alert/{id}
    method: POST
    data_selector: filters
    params: {}
- name: alert_list
  endpoint:
    path: /shodan/alert/info
    method: GET
    data_selector: filters
    params: {}
- name: alert_triggers
  endpoint:
    path: /shodan/alert/triggers
    method: GET
    data_selector: filters
    params: {}
- name: ports
  endpoint:
    path: /shodan/ports
    method: GET
    data_selector: ports
    params: {}
- name: protocols
  endpoint:
    path: /shodan/protocols
    method: GET
    data_selector: protocols
    params: {}
- name: scan
  endpoint:
    path: /shodan/scan
    method: POST
    data_selector: scan
    params: {}
- name: scan_internet
  endpoint:
    path: /shodan/scan/internet
    method: POST
    data_selector: scan_internet
    params: {}
- name: scans
  endpoint:
    path: /shodan/scans
    method: GET
    data_selector: matches
    params: {}
- name: scan_status
  endpoint:
    path: /shodan/scan/{id}
    method: GET
    data_selector: status
    params: {}
- name: notifier
  endpoint:
    path: /notifier
    method: GET
    data_selector: matches
- name: notifier_provider
  endpoint:
    path: /notifier/provider
    method: GET
    data_selector: matches
- name: shodan_query
  endpoint:
    path: /shodan/query
    method: GET
    data_selector: matches
- name: shodan_query_search
  endpoint:
    path: /shodan/query/search
    method: GET
    data_selector: matches
- name: shodan_query_tags
  endpoint:
    path: /shodan/query/tags
    method: GET
    data_selector: matches
- name: shodan_data
  endpoint:
    path: /shodan/data
    method: GET
    data_selector: ''
- name: shodan_data_files
  endpoint:
    path: /shodan/data/{dataset}
    method: GET
    data_selector: ''
- name: organization
  endpoint:
    path: /org
    method: GET
    data_selector: records
    params: {}
- name: account_profile
  endpoint:
    path: /account/profile
    method: GET
    data_selector: records
    params: {}
- name: dns_domain
  endpoint:
    path: /dns/domain/{domain}
    method: GET
    data_selector: records
    params: {}
- name: dns_resolve
  endpoint:
    path: /dns/resolve
    method: GET
    data_selector: records
    params: {}
- name: dns_reverse
  endpoint:
    path: /dns/reverse
    method: GET
    data_selector: records
    params: {}
- name: http_headers
  endpoint:
    path: /tools/httpheaders
    method: GET
    data_selector: records
    params: {}
- name: my_ip
  endpoint:
    path: /tools/myip
    method: GET
    data_selector: records
    params: {}
- name: api_info
  endpoint:
    path: /api-info
    method: GET
    data_selector: records
    params: {}
- name: banners
  endpoint:
    path: /shodan/banners
    method: GET
    data_selector: banners
- name: asn
  endpoint:
    path: /shodan/asn/{asn}
    method: GET
    data_selector: banners
- name: ports
  endpoint:
    path: /shodan/ports/{ports}
    method: GET
    params: {}
- name: countries
  endpoint:
    path: /shodan/countries/{countries}
    method: GET
    data_selector: banners
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: stream_ports
  endpoint:
    path: /stream/ports
    method: GET
    data_selector: banners
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: http
  endpoint:
    path: /
    method: GET
    data_selector: html
    params: {}
- name: vulnerabilities
  endpoint:
    path: /shodan/vulns/{vulns}
    method: GET
    data_selector: banners
    params: {}
- name: stream_vulns
  endpoint:
    path: /vulns
    method: GET
    data_selector: banners
    params:
      countries: CVE-2017-7679,CVE-2018-15919
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: custom_query
  endpoint:
    path: /shodan/custom
    method: GET
    data_selector: banners
    params:
      query: port:8080,443
- name: stream_custom
  endpoint:
    path: /stream/custom
    method: GET
    data_selector: banners
    params:
      query: port:22 SSH-2.0-OpenSSH_6.4
- name: network_alerts
  endpoint:
    path: /shodan/alert
    method: GET
    data_selector: banners
- name: network_alert_by_id
  endpoint:
    path: /shodan/alert/{id}
    method: GET
    data_selector: banners
- name: search
  endpoint:
    path: /api/v1/search
    method: GET
    params:
      query: '{query}'
      facets: '{facets}'
      key: '{YOUR_API_KEY}'
- name: search_filters
  endpoint:
    path: /api/v1/search/filters
    method: GET
    data_selector: ''
    params: {}
- name: search_facets
  endpoint:
    path: /api/v1/search/facets
    method: GET
    data_selector: ''
    params: {}
- name: listAllPorts
  endpoint:
    path: /shodan/ports
    method: GET
- name: listAllProtocols
  endpoint:
    path: /shodan/protocols
    method: GET
- name: requestScan
  endpoint:
    path: /shodan/scan
    method: POST
- name: scanInternet
  endpoint:
    path: /shodan/scan/internet
    method: POST
- name: listScans
  endpoint:
    path: /shodan/scans
    method: GET
- name: getScanStatus
  endpoint:
    path: /shodan/scans/{id}
    method: GET
- name: createAlert
  endpoint:
    path: /shodan/alert
    method: POST
- name: getAlertInfo
  endpoint:
    path: /shodan/alert/{id}/info
    method: GET
- name: deleteAlert
  endpoint:
    path: /shodan/alert/{id}
    method: DELETE
- name: editAlert
  endpoint:
    path: /shodan/alert/{id}
    method: POST
- name: hostInformation
  endpoint:
    path: /shodan/host/{ip}
    method: GET
    data_selector: matches
    params:
      key: YOUR_API_KEY
      ip: '{ip}'
- name: searchHostCount
  endpoint:
    path: /shodan/host/count
    method: GET
    data_selector: total
    params:
      key: YOUR_API_KEY
      query: port:22
- name: searchHost
  endpoint:
    path: /shodan/host/search
    method: GET
    data_selector: matches
    params:
      key: YOUR_API_KEY
      query: port:22
      page: 1
- name: listSearchFacets
  endpoint:
    path: /shodan/host/search/facets
    method: GET
    data_selector: facets
    params:
      key: YOUR_API_KEY
- name: listSearchFilters
  endpoint:
    path: /shodan/host/search/filters
    method: GET
    data_selector: filters
    params:
      key: YOUR_API_KEY
- name: listSearchTokens
  endpoint:
    path: /shodan/host/search/tokens
    method: GET
    data_selector: tokens
    params:
      key: YOUR_API_KEY
      query: your_query
- name: alert_info
  endpoint:
    path: /shodan/alert/info
    method: GET
    data_selector: '[]'
    params:
      key: '{{ dlt.secrets[''api_key''] }}'
- name: alert_triggers
  endpoint:
    path: /shodan/alert/triggers
    method: GET
    data_selector: '[]'
    params:
      key: '{{ dlt.secrets[''api_key''] }}'
- name: enable_trigger
  endpoint:
    path: /shodan/alert/{id}/trigger/{trigger}
    method: PUT
    data_selector: '{}'
    params:
      key: '{{ dlt.secrets[''api_key''] }}'
      id: 0DC55K0N2HHZS3D1
      trigger: open_database
- name: disable_trigger
  endpoint:
    path: /shodan/alert/{id}/trigger/{trigger}
    method: DELETE
    data_selector: '{}'
    params:
      key: '{{ dlt.secrets[''api_key''] }}'
      id: 0DC55K0N2HHZS3D1
      trigger: open_database
- name: notifier
  endpoint:
    path: /notifier
    method: get
    data_selector: matches
    params:
      key: YOUR_API_KEY
- name: notifier_provider
  endpoint:
    path: /notifier/provider
    method: get
    data_selector: matches
    params:
      key: YOUR_API_KEY
- name: organization
  endpoint:
    path: /org
    method: get
    data_selector: name
    params:
      key: YOUR_API_KEY
- name: remove_member
  endpoint:
    path: /organization/member
    method: DELETE
    params:
      key: YOUR_API_KEY
      user: new-member@shodan.io
- name: get_profile
  endpoint:
    path: /account/profile
    method: GET
    params:
      key: YOUR_API_KEY
- name: get_domain_info
  endpoint:
    path: /dns/domain/{domain}
    method: GET
- name: resolveDNS
  endpoint:
    path: /dns/resolve
    method: GET
    data_selector: example
    params:
      key: YOUR_API_KEY
      hostnames: google.com,facebook.com
- name: reverseDNS
  endpoint:
    path: /dns/reverse
    method: GET
    data_selector: example
    params:
      key: YOUR_API_KEY
      ips: 8.8.8.8,1.1.1.1
- name: getHTTPHeaders
  endpoint:
    path: /tools/httpheaders
    method: GET
    data_selector: example
    params:
      key: YOUR_API_KEY
- name: getMyIP
  endpoint:
    path: /tools/myip
    method: GET
    data_selector: example
    params:
      key: YOUR_API_KEY
- name: getAPIInfo
  endpoint:
    path: /api-info
    method: GET
    data_selector: example
    params:
      key: YOUR_API_KEY
notes:
- Requires an API key for authentication
- All API plans are subject to a rate limit of 1 request per second
- Each item is separated by a newline in JSON format.
- Outputs JSON data using the Server-Sent Events protocol in SSE format.
- Uses OAuth2 with refresh token — requires setup of connected app in api
- Some objects like Contact may return nulls in deeply nested fields
- 301 Moved Permanently
- A potential denial of service issue exists in Apache HTTP Server 2.4 due to improperly
  handled requests.
- Use your own API key for authentication.
- Network alerts are renewed periodically every 1 hour.
- Requires API key for access
- To use the API you need to have an API key, which you can get for free by creating
  a Shodan account.
errors:
- Invalid IP
- '400 Bad Request: The request could not be satisfied.'
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- 400 Bad Request
- '404: Not Found'
auth_info:
  mentioned_objects:
  - OauthToken
  - AuthProvider
  - NamedCredential
client:
  base_url: https://api.shodan.io
source_metadata: null
