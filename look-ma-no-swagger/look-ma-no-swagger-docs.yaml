resources:
- name: delete_lab
  endpoint:
    path: /ops/delete-server
    method: POST
    data_selector: request
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: merge_request
  endpoint:
    path: /api/v4/merge_requests
    method: GET
    data_selector: merge_requests
    params: {}
- name: commit
  endpoint:
    path: /api/v4/projects/:id/repository/commits/:sha
    method: GET
    data_selector: commit
    params: {}
- name: repository_file
  endpoint:
    path: /api/v4/projects/:id/repository/files/:file_path
    method: GET
    data_selector: file
    params: {}
- name: KubeAudit
  endpoint:
    path: https://github.com/Shopify/kubeaudit
    method: GET
    data_selector: ''
    params: {}
- name: Polaris
  endpoint:
    path: https://github.com/FairwindsOps/polaris
    method: GET
    data_selector: ''
    params: {}
- name: Gatekeeper
  endpoint:
    path: https://github.com/open-policy-agent/gatekeeper
    method: GET
    data_selector: ''
    params: {}
- name: Audit2RBAC
  endpoint:
    path: https://github.com/liggitt/audit2rbac
    method: GET
    data_selector: ''
    params: {}
- name: Kube-Hunter
  endpoint:
    path: https://github.com/aquasecurity/kube-hunter
    method: GET
    data_selector: ''
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: labs
  endpoint:
    path: /labs
    method: GET
    data_selector: labs
    params: {}
- name: distroless_image
  endpoint:
    path: /distroless/python2.7
    method: GET
    data_selector: artifacts
    params: {}
- name: user
  endpoint:
    path: /dynamo-user
    method: SCAN
    data_selector: ALL_ATTRIBUTES
    params:
      ScanFilter:
        first_name:
          AttributeValueList:
          - S: Joe
          ComparisonOperator: EQ
        last_name:
          AttributeValueList:
          - S: Sixpack
          ComparisonOperator: EQ
- name: assessment_target
  endpoint:
    path: /aws/inspector/assessment-targets
    method: GET
    data_selector: assessmentTargets
    params: {}
- name: resource_group
  endpoint:
    path: /aws/inspector/resource-groups
    method: GET
    data_selector: resourceGroups
    params: {}
- name: assessment_template
  endpoint:
    path: /aws/inspector/assessment-templates
    method: GET
    data_selector: assessmentTemplates
    params: {}
- name: ZAP Active Scan
  endpoint:
    path: /active_scan
    method: POST
- name: ZAP Get Scan Status
  endpoint:
    path: /get_ascan_status
    method: POST
- name: ZAP Write JSON Report
  endpoint:
    path: /write_json_report
    method: POST
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: user_posts
  endpoint:
    path: /me/posts
    method: GET
    data_selector: data
- name: user_friends
  endpoint:
    path: /me/friends
    method: GET
    data_selector: data
notes:
- Uses OAuth2 with refresh token â€” requires setup of connected app in api
- Some objects like Contact may return nulls in deeply nested fields
- Lambda's caching of Global variables when the Lambda function is warm can lead to
  security vulnerabilities.
- Environment variables injected into CI jobs can be accessed by scripts.
- Only `.js` files are scanned for security analysis.
- This works for me and my colleagues. These may not exactly work the same way for
  you.
- Learn to code. In something. For all the reasons below. You dont need to be a Software
  Engineer, but you need to know how to write and read code.
- Start adopting and running with a cloud-native view of the world. This means, understanding
  Cloud API, Attack Patterns and Cloud-native services. This will serve you well in
  the long-run.
- Automation is your friend. Most AppSec Teams are understaffed (in comparison to
  engineering teams and QA teams). Automation is only going to make your job and life
  easier. Adopt and grow with it.
- AWS allows me to leverage User Pool Authorizers with API Gateway.
- Threat Models are generated as tomes, rarely used by the people who need to be using
  it.
- Threat Modeling does not scale.
- Keep your scope small to facilitate the ability to leverage patterns from features.
- tested on Ubuntu 18.04
- Serverless tech has security challenges including event-driven flaws and financial
  exhaustion risks.
- Uses serverless architecture for provisioning lab environments.
- Cold-start issues may affect performance.
- CVE is not a comprehensive list of all possible flaws against publicly available
  software packages.
- CWE is not a database of vulnerabilities. It's a categorization system for vulnerabilities
  and weaknesses in software.
- GraphQL requires deeper thought into your Threat Model and a lot more discipline
  in the SDLC
- Distroless images come with NO package manager, shell and other programs
- DynamoDB supports CRUD operations including INSERT, UPDATE, DELETE, QUERY & SCAN.
- Using scan() can lead to NoSQL Injection vulnerabilities.
- Amazon Inspector is an agent-based service.
- Amazon Inspector works only for deployments in specific AWS regions.
- ZAP's API is extremely powerful and allows control over operational aspects.
- Consider tailoring scan policies to suit specific applications.
- A holistic approach to appsec is absolutely required, rather than a purely exploit/bug
  hunting approach to application security.
- An HMAC is a recipe for a Hashing algorithm to be used as a Message Authentication
  Code.
- For an HMAC to work, you would need an HMAC Implementation of a Hashing Algorithm,
  a Secret Key, and a Message.
- The use of HMACS for TLS has definitely increased the level of security provided
  for TLS implementations.
- The OWASP Top 10 2017 is a solid list capturing common attacks in application security.
- Merging access control flaws into a single category improves focus on authorization
  flaws.
- Insufficient logging and monitoring requires more respect from engineering and security
  communities.
- Requires user permission for accessing friends and posts
- Rate limits apply based on user interactions
- Education about security must be relevant and constant.
- Security remains an afterthought in many fintech companies.
- This account of mine, by no means is the only way to get past a plateau.
errors:
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- '404 Not Found: Check if the project ID or commit SHA is correct.'
- '401 Unauthorized: Verify the Personal Access Token.'
- 'COLD_START: Function performance may be impacted due to cold-start latency.'
- 'CVE-2019-6340: This Drupal Vulnerability has been given an ID.'
- Potentially unhandled NoSQL Injection attacks.
- 'InvalidClientTokenId: The security token included in the request is invalid.'
- 'AccessDeniedException: User is not authorized to perform this operation.'
- 'OAuthException: Invalid OAuth access token'
- 'GraphMethodException: Unsupported get request'
auth_info:
  mentioned_objects:
  - OauthToken
  - AuthProvider
  - NamedCredential
  - GitlabMRScanner
  - UserAccessToken
  - AppSecretProof
client:
  base_url: https://www.gitlab.com
  auth:
    type: apikey
    location: header
    header_name: PRIVATE-TOKEN
source_metadata: null
