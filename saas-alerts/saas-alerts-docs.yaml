resources:
- name: File Share Event - External Orphaned Link
  endpoint:
    path: /hc/en-us/articles/6326297645965-File-Share-Event-External-Orphaned-Link
    method: GET
    data_selector: document
    params: {}
- name: File Share Event - Internal
  endpoint:
    path: /hc/en-us/articles/6326563438093-File-Share-Event-Internal
    method: GET
    data_selector: events
    params: {}
- name: File Share Event - Local Download
  endpoint:
    path: /api/v1/file_share_event/local_download
    method: GET
    data_selector: data
    params: {}
- name: IAM Event - Account Locked
  endpoint:
    path: /hc/en-us/articles/6326683045773-IAM-Event-Account-Locked
    method: GET
    data_selector: event
- name: IAM Event - Multiple SaaS Connections From Different IP Addresses
  endpoint:
    path: /hc/en-us/articles/6327374259981-IAM-Event-Multiple-SaaS-Connections-From-Different-IP-Addresses
    method: GET
    data_selector: event
    params: {}
- name: IAM Event - New User Added
  endpoint:
    path: /hc/en-us/articles/6327454238605-IAM-Event-New-User-Added
    method: GET
    data_selector: event
    params: {}
- name: Alerts
  endpoint:
    path: /hc/en-us/articles/6515940631821-Alerts-appearing-to-come-from-an-incorrect-organization-Cross-Tenant-Alerts
    method: GET
    data_selector: alerts
    params: {}
- name: Single Sign-On
  endpoint:
    path: /hc/en-us/articles/37270749004045-KaseyaOne-Single-Sign-On
    method: GET
- name: monitored_events
  endpoint:
    path: /monitored/events
    method: GET
    data_selector: events
    params: {}
notes:
- The domain must match the location of your Webhook endpoint.
- If the domain validation fails, please check your domain to make sure that it can
  be publicly reached.
- SaaS Alerts enables MSPs to protect and monetize their customer's core SaaS business
  applications with a multi-tenant real-time monitoring platform that protects against
  data theft and actions taken by bad actors.
- Microsoft requires 2 API connections and two popups to be accepted, the first is
  for the Entra API and the second is for the MS Graph API
- Ensure that each organization connection is created with a unique local-global admin
- The account is required to be an 'interactive' account and NOT a non-interactive
  account.
- If an MFA check does not occur the connection will fail.
- No additional action is required, the logged event may be useful for future forensic
  analysis.
- For security reasons, the file path shown in SaaS Alerts is not included when exporting
  data from the Analyze Module.
- The account is automatically unlocked after 15 minutes.
- If the Account is locked by this repeated action more than 3 times within 12 hours,
  SaaS Alerts creates an IAM Event - Multiple Account Locks Alert.
- A login authorization token was revoked for a user accessing a resource.
- This event is triggered when a password is reset or changed during a session while
  other sessions are open.
- Blocking an account can take up to 24 hours to take effect.
- An additional note to be aware of is that a conditional access violation may be
  preceded by a successful login event.
- The Multiple Account lock event Logic is unique to SaaS Alerts and this event is
  not created by Microsoft internally
- Microsoft Conditional Access rules do not prevent a user account from completing
  a sign-in.
- This event provides the ability to observe application logins for a single application,
  which can commonly occur from multiple IP Addresses because of connections from
  multiple devices.
- Additional information is not available for this event.
- Oauth Granted Permissions (shadow IT tracking) - Tracking what other SaaS Apps used
  Google Workspace and/or Microsoft credentials to log in without permissions to directly
  access a primary app.
- This app is blocked message appears when connecting Google Workspace due to a new
  security step Google has implemented to ensure only Administrator approved API connections
  are allowed.
- Microsoft licensing requirements may affect data retrieval
- Account used for API connection must not be deleted
- Ensure auditing is enabled in the Microsoft tenant.
- If auditing fails to enable, wait for 12-24 hours and try again.
- A network error can occur due to high latency or lack of connectivity.
- Certain filtering services may block the SaaS Alerts URL.
- Anti-virus software may prevent SaaS Alerts from loading correctly.
- When alerts appear mixed between tenants, it is due to either the partner CSP admin
  account being used to connect the multiple customer organizations to SaaS Alerts
  or a global admin account having access to more than a single organization tenant
  used for connections.
- API Authorization Required - MSGraph permissions Reports.Read.All
- Orphaned links are links to files shared by users that are accessible to anyone
  on the internet.
- We've seen a lot of users share links to budgets and income statements that end
  up being orphaned links.
- SaaS Alerts polls the audit logs and other discrete data endpoints every 10 minutes
  to provide up to date activity monitoring and event alerts
- Uses OAuth2 with refresh token â€” requires setup of connected app in SaaS Alerts
- Fortify not showing Organizations that belong to Group
- K1 OAuth button fix
- Foreign Applications Report - Export shows incorrect data in Description column
- Some objects may return nulls in deeply nested fields
- The operation couldn't be performed because 'Default' matches multiple entries.
- 'Custom recAction: Dynamic CAP: Fortify block known compromised IP addresses conditional
  access policy.'
- If the Global Admin account used to create a Respond connection has its permissions
  diminished, password changed, or sign-in blocked the Respond connection will break
  and have to be re-established once the account is restored to Global Admin and sign-in
  is unblocked for that account.
- Allowing Users to Login with KaseyaOne will enable access using your K1 account
  as the authentication method.
- When enabling Automatic User Creation, users will be able just to click Sign-In
  with K1 and the SaaS Alerts user will be created automatically based on the KaseyaOne
  subscription.
- Only snapshots with the configured state of enabled or report-only will be imported.
  Disabled snapshots will be ignored.
- If conditional access policies are configured to include or exclude a specific user,
  these will be removed during the import.
- MSP Admin privileges required
- When using IoCs combined with the Respond module, sign in with Microsoft, K1 or
  Google OAuth or Enable MFA in SaaS Alerts user settings
- Please disable MFA if you choose to use Google, K1 or Microsoft Authentication
- IoCs will be scanned every 5 minutes to check for the occurrence of any conditions
  set in the rule
- Each existing Microsoft connection for Manage will need to be upgraded in order
  to access the Mailbox Forwarding Rule report.
- Any new connection will automatically be created with the necessary permissions.
- When your support need is completed, either deactivate or delete the account to
  prevent additional logins.
- Creating a SentinelOne API connection requires the creation of a Service Account
  with viewer permissions within the SentinelOne dashboard.
- Suggest extending the user expiration date to a custom value of 3 years.
errors:
- Domain validation failed - unable to reach the specified domain.
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- Google Workspace API Channel Error 401
- 'tenant does not exist: Related to permissions and the status of the Microsoft audit
  log.'
- A network error (such as timeout, interrupted connection or unreachable host) has
  occurred (Client is Offline)
auth_info:
  mentioned_objects: []
client:
  base_url: https://saasalerts.zendesk.com
  headers:
    Accept: application/json
source_metadata: null
