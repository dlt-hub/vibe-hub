resources:
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: Machine
  endpoint:
    path: /api/machine
    method: GET
    data_selector: records
- name: User
  endpoint:
    path: /api/user
    method: GET
    data_selector: records
- name: Alert
  endpoint:
    path: /api/alert
    method: GET
    data_selector: records
- name: Software
  endpoint:
    path: /api/software
    method: GET
    data_selector: records
- name: Vulnerability
  endpoint:
    path: /api/vulnerability
    method: GET
    data_selector: records
- name: permissions
  endpoint:
    path: /api/permissions
    method: POST
    data_selector: permissions
    params: {}
- name: azure_ad_user
  endpoint:
    path: /Get-AzureADUser
    method: GET
    data_selector: records
- name: azure_ad_group
  endpoint:
    path: /Get-AzureADGroup
    method: GET
    data_selector: records
- name: azure_ad_tenant_detail
  endpoint:
    path: /Get-AzureADTenantDetail
    method: GET
    data_selector: records
- name: az_subscription
  endpoint:
    path: /Get-AzSubscription
    method: GET
    data_selector: records
- name: az_resource_group
  endpoint:
    path: /Get-AzResourceGroup
    method: GET
    data_selector: records
- name: az_vm
  endpoint:
    path: /Get-AzVM
    method: GET
    data_selector: records
- name: az_key_vault
  endpoint:
    path: /Get-AzKeyVault
    method: GET
    data_selector: records
- name: azure_ad_device
  endpoint:
    path: /Get-AzureADDevice
    method: GET
    data_selector: records
- name: azure_ad_group_owner
  endpoint:
    path: /Get-AzureADGroupOwner
    method: GET
    data_selector: records
- name: az_role_assignment
  endpoint:
    path: /Get-AzRoleAssignment
    method: GET
    data_selector: records
- name: az_ad_service_principal
  endpoint:
    path: /Get-AzADServicePrincipal
    method: GET
    data_selector: records
- name: azure_ad_directory_role
  endpoint:
    path: /Get-AzureADDirectoryRole
    method: GET
    data_selector: records
- name: azure_ad_directory_role_member
  endpoint:
    path: /Get-AzureADDirectoryRoleMember
    method: GET
    data_selector: records
- name: azure_ad_application
  endpoint:
    path: /Get-AzureADApplication
    method: GET
    data_selector: records
- name: azure_ad_application_owner
  endpoint:
    path: /Get-AzureADApplicationOwner
    method: GET
    data_selector: records
- name: AzureADUser
  endpoint:
    path: /Get-AzureADUser
    method: GET
- name: AzureADGroup
  endpoint:
    path: /Get-AzureADGroup
    method: GET
- name: AzureTenantDetail
  endpoint:
    path: /Get-AzureADTenantDetail
    method: GET
- name: Subscription
  endpoint:
    path: /Get-AzSubscription
    method: GET
- name: ResourceGroup
  endpoint:
    path: /Get-AzResourceGroup
    method: GET
- name: VM
  endpoint:
    path: /Get-AzVM
    method: GET
- name: KeyVault
  endpoint:
    path: /Get-AzKeyVault
    method: GET
- name: AzureADDevice
  endpoint:
    path: /Get-AzureADDevice
    method: GET
- name: GroupOwner
  endpoint:
    path: /Get-AzureADGroupOwner
    method: GET
- name: RoleAssignment
  endpoint:
    path: /Get-AzRoleAssignment
    method: GET
- name: ServicePrincipal
  endpoint:
    path: /Get-AzADServicePrincipal
    method: GET
- name: DirectoryRole
  endpoint:
    path: /Get-AzureADDirectoryRole
    method: GET
- name: DirectoryRoleMember
  endpoint:
    path: /Get-AzureADDirectoryRoleMember
    method: GET
- name: Application
  endpoint:
    path: /Get-AzureADApplication
    method: GET
- name: ApplicationOwner
  endpoint:
    path: /Get-AzureADApplicationOwner
    method: GET
- name: application
  endpoint:
    path: /api/v1.0.20/applications
    method: GET
- name: data
  endpoint:
    path: /api/data
    method: GET
    data_selector: records
- name: custom_file_upload
  endpoint:
    path: /upload
    method: SFTP
    data_selector: file
    params: {}
- name: upload
  endpoint:
    path: /upload
    method: SFTP/ SCP
    data_selector: files
    params: {}
- name: Server Info
  endpoint:
    path: /WebApp/API/ServerResource/ProductServers
    method: GET
- name: Security Agents
  endpoint:
    path: /WebApp/API/AgentResource/ProductAgents
    method: GET
- name: Investigation Results
  endpoint:
    path: /WebApp/OSCE_iES/OsceIes/ApiEntry
    method: PUT
- name: RCA CSV File
  endpoint:
    path: /WebApp/OSCE_iES/OsceIes/ApiEntry
    method: PUT
- name: server_info
  endpoint:
    path: /WebApp/API/ServerResource/ProductServers
    method: GET
- name: security_agents
  endpoint:
    path: /WebApp/API/AgentResource/ProductAgents
    method: GET
- name: investigation_results
  endpoint:
    path: /WebApp/OSCE_iES/OsceIes/ApiEntry
    method: PUT
- name: rca_csv_file
  endpoint:
    path: /WebApp/OSCE_iES/OsceIes/ApiEntry
    method: PUT
notes:
- Application name should be unique, recommended names are 'Epiphany' or 'EIP'.
- Uses OAuth2 with refresh token — requires setup of connected app in api
- Some objects like Contact may return nulls in deeply nested fields
- Epiphany helps organizations understand the risks that can cause a material impact,
  making it possible to stop attackers before they reach critical systems.
- This section is under construction. Please excuse the dust.
- Requires setup of connected app in api
- This document shows how Epiphany helps organizations understand the risks that can
  cause a material impact.
- Epiphany Intelligence Platform requires a Microsoft Azure Active Directory (Azure
  AD) user account assigned to the role of Workstation & Server admin to collect and
  ingest information about Azure AD resources.
- An account with global reader privileges is required.
- The organization ID is the same as the tenant ID.
- Select the expiration period in alignment with your organization’s standards.
- For Epiphany to gather data and perform analysis, an account with global reader
  privileges is required.
- The application requires the role of global reader, because it won't have any permissions
  assigned to it by default.
- You must select 'Grant consent' for the new permission to take effect.
- Every time you add a permission, you must select 'Grant consent' for the new permission
  to take effect.
- This feature is in Early Release/BETA.
- The Epiphany Intelligence Platform only requires read rights to certain Carbon Black
  Cloud assets.
- This feature is in Early Release/BETA. Please contact your Epiphany Systems support
  or sales contact to learn more.
- Epiphany requires read-only access to Cisco appliances, which can be configured
  using creating user privileges.
- If SSH collection is used, SSH access to network appliances by Epiphany on-prem
  collector.
- Epiphany only requires a read-only user to collect Claroty's data. This is a default
  role in Claroty when generating the API credentials.
- Epiphany only requires a read-only user to collect Claroty's data.
- Epiphany only requires a read-only set of API credentials to collect Crowdstrike's
  data.
- The Epiphany Intelligence Platform only requires reader access to Cylance, which
  is one of the default roles within the system.
- Epiphany requires a Cylance 'application' account to collect and ingest information
  from the Cylance API.
- The Epiphany Intelligence Platform requires read-only access to the Patch Manager
  Plus API, which is one of the default roles within the system.
- Requires read-only access to the Patch Manager Plus API
- Permissions granted to the API key will be limited to those assigned to the delegated
  user’s role
- Epiphany only requires a read-only (Default Dashboard Role) user to collect NCentral's
  data.
- Ability to create a user, or access to an existing user with the read-only role.
- Requires a private key in PEM format for authentication
- Files can be uploaded via SCP or SFTP
- This PEM file is the private key for the 'upload' account on the collector and should
  be placed in a secure location available only to the users who will be moving data
  into the platform.
- Qualys allows API access by virtue of a username and password combination.
- Qualys allows API access by virtue of a username and password combination, which
  can be created in the management console by an admin user.
- The Epiphany Intelligence Platform only requires reader access to Qualys, which
  is one of the default roles within the system.
- The Epiphany Intelligence Platform only requires reader access to Rapid7 Nexpose,
  which is one of the default roles within the system.
- Requires reader access to Rapid7 Nexpose, which is one of the default roles.
- Epiphany only requires viewer access to SentinelOne, which is one of the default
  roles within the system.
- Epiphany only requires viewer access to Tenable, which is one of the default roles
  within the system.
- There is no role-based access control (RBAC) for Trend Micro Apex One.
- Access to the Trend Micro Cloud One Console to generate an API Key with read permissions.
- API access by virtue of an API key, which can be created in the Trend Micro Cloud
  One console by an individual user.
- The permissions granted to the API key will be limited to those of the role it is
  assigned during creation.
- An AD service account to authenticate to AD environments is required.
- A Windows GPO must be applied.
- An Epiphany site collector needs to be deployed for data ingestion.
- Data Source Name is required.
- HostnameURL must be entered correctly.
- Apex Central App ID is required.
- API Key is required.
- Allowing Epiphany to enumerate users and groups in the local Security Accounts Manager
  (SAM) database and Active Directory within your organization's domain will provide
  you with a qualitative risk based on your permission boundaries and privilege use.
- A WMI filter should be applied to the GPO to ensure the policy is only applied to
  the specific versions of Windows listed in this article.
- Refer to the guides for authentication setup.
errors:
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
auth_info:
  mentioned_objects:
  - OauthToken
  - AuthProvider
  - NamedCredential
  - Application ID
  - Tenant ID
client:
  base_url: https://reveald.com
  auth:
    type: oauth2
source_metadata: null
