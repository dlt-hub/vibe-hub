resources:
- name: alerts
  endpoint:
    path: /apis/alerts_api/
    method: GET
- name: endpoint_assets
  endpoint:
    path: /apis/assets_endpoints_api/
    method: GET
- name: audits
  endpoint:
    path: /apis/audits_api/
    method: GET
- name: automation
  endpoint:
    path: /apis/automation_api/
    method: GET
- name: byoti
  endpoint:
    path: /apis/byoti_api/
    method: GET
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: signed-s3url
  endpoint:
    path: /s3-signer/v2/signed-s3url
    method: POST
- name: laptop_penetration_test
  endpoint:
    path: /services/incident-response/imr-services-catalog/laptop-penetration-test/
    method: GET
- name: medical_device_test
  endpoint:
    path: /services/incident-response/imr-services-catalog/medical-device-test/
    method: GET
- name: microsoft_entra_id_security_assessment
  endpoint:
    path: /services/incident-response/imr-services-catalog/microsoft_entra_id_security_assessment/
    method: GET
- name: mobile_application_security_assessment
  endpoint:
    path: /services/incident-response/imr-services-catalog/mobile-application-security-assessment/
    method: GET
- name: password_analysis
  endpoint:
    path: /services/incident-response/imr-services-catalog/password-analysis/
    method: GET
- name: physical_security_testing
  endpoint:
    path: /services/incident-response/imr-services-catalog/physical_security_testing/
    method: GET
- name: sap_penetration_test
  endpoint:
    path: /services/incident-response/imr-services-catalog/sap-penetration-test/
    method: GET
- name: secure_code_analysis
  endpoint:
    path: /services/incident-response/imr-services-catalog/secure-code-analysis/
    method: GET
- name: threat_hunting_assessment
  endpoint:
    path: /services/incident-response/imr-services-catalog/threat-hunting-assessment/
    method: GET
- name: vulnerability_assessment
  endpoint:
    path: /services/incident-response/imr-services-catalog/vulnerability_assessment/
    method: GET
- name: web_application_security_assessment
  endpoint:
    path: /services/incident-response/imr-services-catalog/web-application-security-assessment/
    method: GET
- name: web_service_test
  endpoint:
    path: /services/incident-response/imr-services-catalog/web-service-test/
    method: GET
- name: wireless_network_penetration_test
  endpoint:
    path: /services/incident-response/imr-services-catalog/wireless-network-penetration-test/
    method: GET
- name: alerts
  endpoint:
    path: /alerts
    method: GET
    data_selector: alerts
    params:
      detector_id: app:file-analysis
- name: diagnostic_settings
  endpoint:
    path: /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Insights/diagnosticSettings
    method: GET
    data_selector: value
    params: {}
- name: assets
  endpoint:
    path: /assets
    method: GET
    data_selector: records
- name: scans
  endpoint:
    path: /scans
    method: GET
    data_selector: records
- name: users
  endpoint:
    path: /users
    method: GET
- name: tenants
  endpoint:
    path: /tenants
    method: GET
- name: countermeasures
  endpoint:
    path: /countermeasures
    method: GET
- name: data_availability
  endpoint:
    path: /data/availability
    method: GET
    data_selector: records
- name: data_provided
  endpoint:
    path: /data/provided
    method: GET
    data_selector: records
- name: alerts
  endpoint:
    path: /api/alerts
    method: GET
    data_selector: records
    params: {}
- name: endpoint_assets
  endpoint:
    path: /api/endpoint_assets
    method: GET
    data_selector: records
    params: {}
- name: assets
  endpoint:
    path: /api/assets
    method: GET
    data_selector: records
    params: {}
- name: vulnerabilities
  endpoint:
    path: /api/vulnerabilities
    method: GET
    data_selector: records
    params: {}
- name: detections
  endpoint:
    path: /api/detections
    method: GET
    data_selector: detections
    params: {}
- name: auth
  endpoint:
    path: /api/auth
    method: GET
    data_selector: auth
    params: {}
- name: dns
  endpoint:
    path: /api/dns
    method: GET
    data_selector: dns
    params: {}
- name: file_collection
  endpoint:
    path: /api/file_collection
    method: GET
    data_selector: file_collection
    params: {}
- name: http
  endpoint:
    path: /api/http
    method: GET
    data_selector: http
    params: {}
- name: nids
  endpoint:
    path: /api/nids
    method: GET
    data_selector: nids
    params: {}
- name: netflow
  endpoint:
    path: /api/netflow
    method: GET
    data_selector: netflow
    params: {}
- name: process
  endpoint:
    path: /api/process
    method: GET
    data_selector: process
    params: {}
- name: file_modification
  endpoint:
    path: /api/file_modification
    method: GET
    data_selector: file_modification
    params: {}
- name: api_call
  endpoint:
    path: /api/api_call
    method: GET
    data_selector: api_call
    params: {}
- name: registry
  endpoint:
    path: /api/registry
    method: GET
    data_selector: registry
    params: {}
- name: scriptblock
  endpoint:
    path: /api/scriptblock
    method: GET
    data_selector: scriptblock
    params: {}
- name: management
  endpoint:
    path: /api/management
    method: GET
    data_selector: management
    params: {}
- name: persistence
  endpoint:
    path: /api/persistence
    method: GET
    data_selector: persistence
    params: {}
- name: thread_injection
  endpoint:
    path: /api/thread_injection
    method: GET
    data_selector: thread_injection
    params: {}
- name: detection_finding
  endpoint:
    path: /api/detection_finding
    method: GET
    data_selector: detection_finding
    params: {}
- name: technique_finding
  endpoint:
    path: /api/technique_finding
    method: GET
    data_selector: technique_finding
    params: {}
- name: generic
  endpoint:
    path: /api/generic
    method: GET
    data_selector: generic
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: alerts
  endpoint:
    path: /api/alerts
    method: GET
    data_selector: data
    params: {}
- name: endpoint_assets
  endpoint:
    path: /api/endpoint/assets
    method: GET
    data_selector: data
    params: {}
- name: audits
  endpoint:
    path: /api/audits
    method: GET
    data_selector: data
    params: {}
- name: firewall_events
  endpoint:
    path: /v1/firewall/events
    method: GET
    data_selector: events
- name: threats
  endpoint:
    path: /v1/threats
    method: GET
    data_selector: threats
- name: alerts
  endpoint:
    path: /alerts_api/
    method: GET
- name: endpoint_assets
  endpoint:
    path: /assets_endpoints_api/
    method: GET
- name: audits
  endpoint:
    path: /audits_api/
    method: GET
- name: automation
  endpoint:
    path: /automation_api/
    method: GET
- name: byoti
  endpoint:
    path: /byoti_api/
    method: GET
- name: collector
  endpoint:
    path: /collector_api/
    method: GET
- name: investigations_v2
  endpoint:
    path: /investigations_v2_api/
    method: GET
- name: investigations
  endpoint:
    path: /investigations_api/
    method: GET
- name: threat_intelligence
  endpoint:
    path: /ti_api/
    method: GET
- name: users
  endpoint:
    path: /users_api/
    method: GET
- name: tenants
  endpoint:
    path: /tenants_api/
    method: GET
- name: countermeasures
  endpoint:
    path: /countermeasures_api/
    method: GET
- name: file_upload
  endpoint:
    path: /file_upload_api/
    method: GET
- name: notifications
  endpoint:
    path: /notifications_api/
    method: GET
- name: vulnerability_assessment_export
  endpoint:
    path: /api/v2/vulnerability-groups/export
    method: POST
    data_selector: export
    params: {}
- name: asset_list_export
  endpoint:
    path: /api/v2/websites/export
    method: POST
    data_selector: export
    params: {}
- name: vulnerability_list_export
  endpoint:
    path: /api/v2/vulnerability-groups/export
    method: POST
    data_selector: export
    params: {}
- name: alerts
  endpoint:
    path: alerts_api/
    method: GET
- name: endpoint_assets
  endpoint:
    path: assets_endpoints_api/
    method: GET
- name: audits
  endpoint:
    path: audits_api/
    method: GET
- name: automation
  endpoint:
    path: automation_api/
    method: GET
- name: byoti
  endpoint:
    path: byoti_api/
    method: GET
- name: collector
  endpoint:
    path: collector_api/
    method: GET
- name: investigations_v2
  endpoint:
    path: investigations_v2_api/
    method: GET
- name: threat_intelligence
  endpoint:
    path: ti_api/
    method: GET
- name: users
  endpoint:
    path: users_api/
    method: GET
- name: tenants
  endpoint:
    path: tenants_api/
    method: GET
- name: countermeasures
  endpoint:
    path: countermeasures_api/
    method: GET
- name: file_upload
  endpoint:
    path: file_upload_api/
    method: GET
- name: notifications
  endpoint:
    path: notifications_api/
    method: GET
notes:
- Uses OAuth2 with refresh token — requires setup of connected app in api
- Access tokens are only valid for a few hours, so your application must repeat this
  process as necessary.
- The number of client credentials that can be created for a tenant in an hour is
  limited to 10.
- Uses OAuth2 with client credentials flow
- Some objects like Contact may return nulls in deeply nested fields
- Before proceeding, complete the API Authentication steps in order to obtain a working
  access token.
- With a single PUT operation, you can upload files up to 100 MB in size.
- The minimum file size is 1024 bytes.
- The Access Token is valid for 10 hours and should be cached rather than creating
  a new Token with each operation.
- API Rate Limiting
- The Secureworks Professional Services team is here to help you realize the full
  potential from your Taegis XDR investment if a higher level of support is desired.
- Taegis platform does implement rate limiting rules for API usage.
- If you receive HTTP error code 429, this indicates that the limit has been reached.
- File upload capability requires a Taegis Endpoint Agent version ≥ 1.2.
- Requires Azure subscription and proper permissions.
- Make sure to handle pagination when fetching multiple diagnostic settings.
- API supports both REST and GraphQL
- Azure integrations are supported in US and EU regions, but may not be supported
  by Microsoft in other regions.
- Requires setup of connected app in api
- Some objects may return nulls in deeply nested fields
- You must turn on Office 365 audit logging for XDR to receive data from it.
- XDR supports ONLY the Privacy-Enhanced Mail (PEM) format.
- Get Started with XDR APIs
- XDR GraphQL APIs Authentication
- Microsoft Defender for Endpoint integration requires appropriate Microsoft licensing
  and an active Azure subscription.
- Each Azure Active Directory tenant ID can be used with only one XDR integration.
- Uses OAuth2 with refresh token — requires setup of connected app in API
- Ensure API access is enabled in Sophos XGS settings.
- Use https://www.getpostman.com/oauth2/callback as a redirect URI.
- Uses JWT for authentication
- Since a vulnerability assessment report contains dates and times, it is possible
  to provide a UTC offset in minutes (positive or negative integer) to avoid any confusion
  to the reader.
- Log in to VDR
- Ensure all API usage complies with rate limits
errors:
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- 'Existing client in tenant: Try changing the application name.'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '429: Rate limit exceeded'
- '400 Bad Request: Check the request parameters.'
- '401 Unauthorized: Ensure valid credentials.'
- '404 Not Found: Verify resource ID and names.'
- '401 Unauthorized: Check client ID and secret.'
- '403 Forbidden: Access denied, check permissions.'
- '429 Too Many Requests: Rate limit exceeded.'
- '400: Request denied due to incorrect token selection'
- '401 Unauthorized: Verify token validity'
- '403 Forbidden: Check user permissions'
- '404 Not Found: Verify endpoint URL'
auth_info:
  mentioned_objects:
  - OauthToken
  - AuthProvider
  - NamedCredential
  - ServicePrincipal
  - ClientID
  - TenantID
client:
  base_url: https://docs.taegis.secureworks.com
  auth:
    type: oauth2
    flow: refresh_token
  headers:
    Accept: application/json
source_metadata: null
