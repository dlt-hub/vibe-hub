resources:
- name: Postgres PVC
  endpoint:
    path: /postgres
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 8
- name: Localstack PVC
  endpoint:
    path: /localstack
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 5
- name: Minio PVC
  endpoint:
    path: /minio
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 8
- name: Redis PVC
  endpoint:
    path: /redis
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 8
- name: Kaniko cache warmer
  endpoint:
    path: /kaniko
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 10
- name: Builder PVC
  endpoint:
    path: /builder
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 10
- name: Worker subtuple
  endpoint:
    path: /worker
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 10
- name: Docker registry
  endpoint:
    path: /registry
    method: GET
    data_selector: records
    params:
      access_mode: ReadWriteOnce
      volume_size: 10
- name: checkpoint
  endpoint:
    path: /_update_from_checkpoint
    method: POST
    data_selector: checkpoint
    params:
      path: path
- name: local_state
  endpoint:
    path: /load_local_state
    method: POST
    data_selector: class
    params:
      path: path
- name: model
  endpoint:
    path: /torch/model
    method: GET
    data_selector: model_data
- name: criterion
  endpoint:
    path: /torch/criterion
    method: GET
    data_selector: criterion_data
- name: optimizer
  endpoint:
    path: /torch/optimizer
    method: GET
    data_selector: optimizer_data
- name: index_generator
  endpoint:
    path: /torch/index_generator
    method: GET
    data_selector: index_generator_data
- name: dataset
  endpoint:
    path: /torch/dataset
    method: GET
    data_selector: dataset_data
- name: predict_dataset
  endpoint:
    path: /predict_dataset
    method: GET
    data_selector: predictions
- name: train_dataset
  endpoint:
    path: /train_dataset
    method: GET
    data_selector: train_data
- name: shared_states
  endpoint:
    path: /shared_states
    method: GET
    data_selector: states
- name: extra_repr
  endpoint:
    path: /torch_fed_pca_algo/extra_repr
    method: GET
    data_selector: returns
    params: {}
- name: float
  endpoint:
    path: /torch_fed_pca_algo/float
    method: GET
    data_selector: returns
    params: {}
- name: forward
  endpoint:
    path: /torch_fed_pca_algo/forward
    method: GET
    data_selector: returns
    params: {}
- name: get_buffer
  endpoint:
    path: /torch_fed_pca_algo/get_buffer
    method: GET
    data_selector: returns
    params: {}
- name: get_extra_state
  endpoint:
    path: /torch_fed_pca_algo/get_extra_state
    method: GET
    data_selector: returns
    params: {}
- name: get_parameter
  endpoint:
    path: /torch_fed_pca_algo/get_parameter
    method: GET
    data_selector: returns
    params: {}
- name: get_submodule
  endpoint:
    path: /torch_fed_pca_algo/get_submodule
    method: GET
    data_selector: returns
    params: {}
- name: half
  endpoint:
    path: /torch_fed_pca_algo/half
    method: GET
    data_selector: returns
    params: {}
- name: ipu
  endpoint:
    path: /torch_fed_pca_algo/ipu
    method: GET
    data_selector: returns
    params: {}
- name: load_state_dict
  endpoint:
    path: /torch_fed_pca_algo/load_state_dict
    method: GET
    data_selector: returns
    params: {}
- name: modules
  endpoint:
    path: /torch_fed_pca_algo/modules
    method: GET
    data_selector: returns
    params: {}
- name: named_buffers
  endpoint:
    path: /torch_fed_pca_algo/named_buffers
    method: GET
    data_selector: returns
    params: {}
- name: named_children
  endpoint:
    path: /torch_fed_pca_algo/named_children
    method: GET
    data_selector: returns
    params: {}
- name: named_modules
  endpoint:
    path: /torch_fed_pca_algo/named_modules
    method: GET
    data_selector: returns
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: summary
  endpoint:
    path: /summary
    method: GET
    data_selector: returns
    params: {}
- name: train
  endpoint:
    path: /train
    method: POST
    data_selector: returns
    params: {}
- name: torch_algo
  endpoint:
    path: /torch_algo
    method: GET
    data_selector: records
- name: dataset
  endpoint:
    path: /torchfedpca/dataset
    method: GET
    data_selector: records
- name: add_parameters
  endpoint:
    path: /add_parameters
    method: POST
    data_selector: parameters
    params: {}
- name: batch_norm_param
  endpoint:
    path: /batch_norm_param
    method: GET
    data_selector: parameters
    params: {}
- name: get_parameters
  endpoint:
    path: /get_parameters
    method: GET
    data_selector: parameters
    params: {}
- name: increment_parameters
  endpoint:
    path: /increment_parameters
    method: POST
    data_selector: parameters
    params: {}
- name: is_batchnorm_layer
  endpoint:
    path: /is_batchnorm_layer
    method: GET
    data_selector: parameters
    params: {}
- name: model_parameters
  endpoint:
    path: /model_parameters
    method: GET
    data_selector: parameters
    params: {}
- name: set_parameters
  endpoint:
    path: /set_parameters
    method: POST
    data_selector: parameters
    params: {}
- name: subtract_parameters
  endpoint:
    path: /subtract_parameters
    method: POST
    data_selector: parameters
    params: {}
- name: weighted_sum_parameters
  endpoint:
    path: /weighted_sum_parameters
    method: POST
    data_selector: parameters
    params: {}
- name: zeros_like_parameters
  endpoint:
    path: /zeros_like_parameters
    method: GET
    data_selector: parameters
    params: {}
- name: dataset
  endpoint:
    path: /pca/data
    method: POST
    data_selector: results
    params: {}
- name: local_train
  endpoint:
    path: /local_train
    method: POST
    data_selector: predictions
    params: {}
- name: predict
  endpoint:
    path: /predict
    method: POST
    data_selector: predictions
    params: {}
- name: save_local_state
  endpoint:
    path: /save_local_state
    method: POST
    data_selector: result
    params: {}
- name: load_local_state
  endpoint:
    path: /load_local_state
    method: GET
    data_selector: state
    params: {}
- name: named_parameters
  endpoint:
    path: named_parameters
    method: GET
    data_selector: parameters
    params: {}
- name: parameters
  endpoint:
    path: parameters
    method: GET
    data_selector: parameters
    params: {}
- name: checkpoint
  endpoint:
    path: /update_from_checkpoint
    method: POST
    data_selector: checkpoint
    params: {}
- name: local_state
  endpoint:
    path: /load_local_state
    method: POST
    data_selector: local_state
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: dataset
  endpoint:
    path: /dataset
    method: GET
    data_selector: data
    params: {}
- name: campaign_member
  endpoint:
    path: /services/data/vXX.X/sobjects/CampaignMember
    method: GET
    data_selector: records
    params:
      incremental: updated_at
- name: contact
  endpoint:
    path: /services/data/vXX.X/sobjects/Contact
    method: GET
    data_selector: records
    params: {}
- name: register_full_backward_hook
  endpoint:
    path: /register_full_backward_hook
    method: POST
- name: register_full_backward_pre_hook
  endpoint:
    path: /register_full_backward_pre_hook
    method: POST
- name: register_load_state_dict_post_hook
  endpoint:
    path: /register_load_state_dict_post_hook
    method: POST
- name: register_state_dict_pre_hook
  endpoint:
    path: /register_state_dict_pre_hook
    method: POST
- name: requires_grad_
  endpoint:
    path: /requires_grad_
    method: POST
- name: set_extra_state
  endpoint:
    path: /set_extra_state
    method: POST
- name: share_memory
  endpoint:
    path: /share_memory
    method: POST
- name: state_dict
  endpoint:
    path: /state_dict
    method: GET
- name: to
  endpoint:
    path: /to
    method: POST
- name: summary
  endpoint:
    path: /summary
    method: GET
    data_selector: returns
    params: {}
- name: train
  endpoint:
    path: /train
    method: POST
    data_selector: returns
    params: {}
- name: EvaluationStrategy
  endpoint:
    path: /evaluation_strategy
    method: GET
    data_selector: records
    params: {}
- name: download_aggregate_shared_state
  endpoint:
    path: /model_download/aggregate_shared_state
    method: GET
    data_selector: Any
    params: {}
- name: download_algo_state
  endpoint:
    path: /model_download/algo_state
    method: GET
    data_selector: Any
    params: {}
- name: download_train_shared_state
  endpoint:
    path: /model_download/train_shared_state
    method: GET
    data_selector: Any
    params: {}
- name: TestDataNode
  endpoint:
    path: /test_data_node
    method: GET
    data_selector: records
    params: {}
- name: Federated Averaging
  endpoint:
    path: /strategies/federated_averaging
    method: GET
    data_selector: records
    params: {}
- name: Scaffold
  endpoint:
    path: /strategies/scaffold
    method: GET
- name: NewtonRaphson
  endpoint:
    path: /substrafl/strategies/NewtonRaphson
    method: GET
    data_selector: records
    params: {}
- name: SingleOrganization
  endpoint:
    path: /substrafl/strategies/SingleOrganization
    method: GET
    data_selector: records
    params: {}
- name: ScaffoldSharedState
  endpoint:
    path: /scaffold/shared/state
    method: GET
- name: Logger
  endpoint:
    path: /logger
    method: POST
    data_selector: loglevel
- name: dataset
  endpoint:
    path: /datasets
    method: POST
    data_selector: key
    params: {}
- name: datasample
  endpoint:
    path: /data_samples
    method: POST
    data_selector: key
    params: {}
- name: function
  endpoint:
    path: /functions
    method: POST
    data_selector: key
    params: {}
- name: dataset
  endpoint:
    path: /datasets
    method: POST
    data_selector: dataset
    params: {}
- name: local_first_order_computation
  endpoint:
    path: /assets/functions/federated_analytics_functions.py
    method: GET
    data_selector: local_first_order_computation
    params: {}
- name: aggregation
  endpoint:
    path: /assets/functions/aggregation/Dockerfile
    method: GET
    data_selector: aggregation
    params: {}
- name: local_second_order_computation
  endpoint:
    path: /assets/functions/local_second_order_computation/Dockerfile
    method: GET
    data_selector: local_second_order_computation
    params: {}
- name: dataset
  endpoint:
    path: /services/data/vXX.X/sobjects/Dataset
    method: POST
    data_selector: dataset
    params: {}
- name: data_samples
  endpoint:
    path: /services/data/vXX.X/sobjects/DataSample
    method: POST
    data_selector: data_samples
    params: {}
- name: functions
  endpoint:
    path: /services/data/vXX.X/sobjects/Function
    method: POST
    data_selector: functions
    params: {}
- name: tasks
  endpoint:
    path: /services/data/vXX.X/sobjects/Task
    method: POST
    data_selector: tasks
    params: {}
- name: dataset
  endpoint:
    path: /datasets
    method: POST
- name: data_sample
  endpoint:
    path: /data_samples
    method: POST
- name: function
  endpoint:
    path: /functions
    method: POST
- name: train_function
  endpoint:
    path: function_random_forest/titanic_function_rf.py
    method: POST
- name: predict_function
  endpoint:
    path: function_random_forest/titanic_function_rf.py
    method: POST
notes:
- After years of continuous development and refinement, we’re excited to announce
  the official release of Substra 1.0, featuring a robust and fully matured API.
- This will the last version offering support for Python 3.9!
- It’s not longer possible to generate never-expiring tokens via the web application.
- Admin and user roles have been introduced.
- 'BREAKING CHANGE: remove the shared local folder of the compute plan'
- 'BREAKING CHANGE: pass the algo method to execute under the `--method-name` argument
  within the within the cli of the task execution.'
- 'BREAKING CHANGE: an extra argument `predictions_path` has been added to both `predict`
  and `_local_predict` methods.'
- Some objects like Contact may return nulls in deeply nested fields.
- The round 0 is now exposed. Possibility to evaluate centralized strategies before
  any training (FedAvg, NR, Scaffold). The round 0 is skipped for single org strategy
  and cannot be evaluated before training.
- Add support for Python 3.10.
- Local dependencies are installed in one pip command to optimize the installation
  and avoid incompatibilities error.
- Fix error when installing current package as local dependency.
- Breaking changes in substra-tools require user code adaptations.
- Metrics can now access results from get_data.
- Uses PyTorch for model training and prediction.
- The train method updates the weights of the model with the aggregated weights.
- A torch scheduler can be called at every batch if provided.
- Uses OAuth2 with refresh token — requires setup of connected app in api
- Some objects like Contact may return nulls in deeply nested fields
- Base TorchAlgo class, all the torch algo classes inherit from it.
- To be inherited. Wraps the necessary operation so a torch model can be trained in
  the Newton-Raphson strategy.
- The seed is mandatory. Default to 1.
- 'Important: Use next(self._index_generator) as batch sampler for correct batches.'
- Duplicate modules are returned only once.
- Newton-Raphson strategy is based on Newton-Raphson distributed method.
- It leads to a faster convergence than a standard FedAvg strategy, however it can
  only be used on convex problems.
- Create a new model by parsing and validating input data from keyword arguments.
- Dataset object is an empty shell. Data samples are needed to add actual data.
- This example is provided as an illustrative example only.
- It is strongly recommended to consider what are the potential security risks in
  your use case.
- The registered task is executed at once in local mode (docker or subprocess).
- In remote mode, the registered task is added to a queue and treated asynchronously.
- This example is provided as an illustrative example only. In real life, you should
  be careful not to accidentally leak private information when doing Federated Analytics.
- Uses Docker or subprocess for task execution
- Assets must be registered before tasks can be created
- The predict function uses the same Python file as the function used for training.
errors:
- 'ERROR: could not serialize access due to read/write dependencies among transactions
  (SQLSTATE 40001)'
- 'NotImplementedError: Ensure the train method is implemented.'
- 'NumUpdatesValueError: If num_updates is inferior or equal to zero.'
- 'BatchSizeNotFoundError: No default batch size have been found to perform local
  prediction.'
- 'REQUEST_LIMIT_EXCEEDED: Throttle API calls or reduce frequency'
- 'QUERY_TIMEOUT: Break down filters or add selectivity'
- '401 Unauthorized: Recheck OAuth scopes or token expiration'
- 'NotImplementedError: Function not implemented'
- 'ValueError: test_data_nodes cannot be an empty list'
- 'TypeError: test_data_nodes must be filled with instances of TestDataNodeProtocol'
- 'TypeError: rounds must be a list or an int'
- 'ValueError: both eval_rounds and eval_frequency cannot be None at the same time'
- 'ArgumentConflictError: Incompatible value in the given arguments.'
- 'BatchSizeNotFoundError: No batch size found.'
- 'CriterionReductionError: The criterion reduction must be set to ‘mean’ to use the
  Newton-Raphson strategy.'
- 'DampingFactorValueError: The damping factor must be greater than 0 and less than
  or equal to 1.'
- 'DatasetSignatureError: The __init__() function on the given torch Dataset must
  have data_from_opener and is_inference as parameters.'
- 'DatasetTypeError: The given torch Dataset should be a torch.utils.data.Dataset
  object and not an instance of it.'
- 'DependencyCacheNotFoundError: No cache directory found for the dependencies.'
- 'EmptySharedStatesError: The shared_states is empty. Ensure that the train method
  of the algorithm returns a StrategySharedState object.'
- 'ExistingRegisteredMetricError: A metric with the same name is already registered.'
- 'IncompatibleAlgoStrategyError: This algo is not compatible with this strategy.'
- 'IndexGeneratorSampleNoneError: Try to use the index generator without setting the
  number of samples.'
- 'IndexGeneratorUpdateError: The index generator has not been updated properly.'
- 'InvalidDependenciesError: The set of constraints given on dependencies cannot be
  solved or is otherwise invalid (wrong package name).'
- 'InvalidMetricIdentifierError: A metric name or identifier cannot be a SubstraFL
  Outputidentifier.'
- 'InvalidPathError: Invalid path.'
- 'InvalidUserModuleError: The local folder passed by the user as a dependency is
  not a valid Python module.'
- 'KeyMetadataError: substrafl_version, substra_version and substratools_version keys
  can’t be added to the experiment metadata.'
- 'LenMetadataError: Too long additional metadata passed to the execute_experiment
  function to be shown on the Substra WebApp.'
- 'LoadFileNotFoundError: The given folder must contains the following files: function.tar.gz,
  metadata.json, the file entered in the model_file key of the dictionary.'
- 'LoadLocalDependencyError: All dependencies from the local input folder should be
  install by the user.'
- 'LoadMetadataError: The metadata.json file within the folder given as input must
  contain a model_file.'
- 'MetricFunctionSignatureError: The metric_function() function on the given torch
  Dataset must ONLY have data_from_opener and predictions as parameters.'
- 'MetricFunctionTypeError: The metric_function() must be of type function.'
- 'MultipleTaskError: The experiment from which to get the algo files can’t have multiple
  task tagged with the given round_idx or rank_idx hosted on the same organization.'
- 'NegativeHessianMatrixError: Hessian matrix is not positive semi-definite, the problem
  is not convex.'
- 'NumUpdatesValueError: The num_update has been set to an non-authorize value.'
- 'OptimizerValueError: The optimizer value is incompatible with the _local_train
  function.'
- 'ScaffoldLearningRateError: When using the TorchScaffoldAlgo, a learning rate must
  be passed to the optimizer.'
- 'SharedStatesError: Shared states error.'
- 'SubstraToolsDeprecationWarning: The substratools version used is deprecated.'
- 'TaskNotFoundError: The provided compute plan must contain a task: hosted by the
  worker associated to the given client tagged with the given round_idx or rank_idx.'
- 'TorchScaffoldAlgoParametersUpdateError: When using TorchScaffoldAlgo, _scaffold_parameters_update()
  method must be called once for each update within the _local_train() method.'
- 'UnfinishedTaskError: The task from which to get the algo files shall be in status
  STATUS_DONE.'
- 'UnsupportedClientBackendTypeError: The given client backend type is not supported
  by the function.'
- 'UnsupportedPythonVersionError: The Python version used is not supported by Substra.'
- 'UnsupportedPytorchVersionError: Unsupported Pytorch version.'
- 'WrongWheelNameError: Error with the extracted wheel name from pip wheel.'
auth_info:
  mentioned_objects:
  - OauthToken
  - AuthProvider
  - NamedCredential
client:
  base_url: http://substra-backend.org-1.com:8000
  auth:
    type: oauth2
    flow: refresh_token
source_metadata: null
